> drop database if exists only_tag cascade;
DROP DATABASE
> create ts database only_tag;
CREATE TS DATABASE
> use only_tag;
SET
> create table table1(ts timestamp not null, a int, b int ) tags (ptag1 int not null, t1 int, t2 int, t3 int) primary tags (ptag1);
CREATE TABLE
> insert into table1 values ('2024-9-12 10:00:00', 1, 2, 100, 1000, 10000, 10000),('2024-9-12 10:00:01', 1, 2, 100, 1000, 10000, 10000),('2024-9-12 10:00:02', 2, 2, 200, 2000, 20000, 20000),('2024-9-12 10:00:03', 3, 2, 300, 3000, 30000, 30000),('2024-9-12 10:00:04', 4, 2, 400, 4000, 40000, 40000),('2024-9-12 10:00:05', 5, 2, 500, 5000, 50000, 50000),('2024-9-12 10:00:06', 6, 2, 600, 6000, 60000, 60000),('2024-9-12 10:00:07', 7, 2, 700, 7000, 70000, 70000);
INSERT 8
> create table table2(ts timestamp not null, a int, b int ) tags (ptag1 int not null, t1 int not null, t2 int, t3 int) primary tags (ptag1, t1);
CREATE TABLE
> insert into table2 values ('2024-9-12 10:00:00', 1, 2, 100, 1000, 10000, 10000),('2024-9-12 10:00:01', 1, 2, 100, 1000, 10000, 10000),('2024-9-12 10:00:02', 2, 2, 200, 2000, 20000, 20000),('2024-9-12 10:00:03', 3, 2, 300, 3000, 30000, 30000),('2024-9-12 10:00:04', 4, 2, 400, 4000, 40000, 40000),('2024-9-12 10:00:05', 5, 2, 500, 5000, 50000, 50000),('2024-9-12 10:00:06', 6, 2, 600, 6000, 60000, 60000),('2024-9-12 10:00:07', 7, 2, 700, 7000, 70000, 70000);
INSERT 8
> create table table3(ts timestamp not null, a int) tags (ptag1 int not null, t1 double, t2 double, t3 double, t4 char(10)) primary tags (ptag1);
CREATE TABLE
> insert into table3 values 
('2024-9-12 10:00:00', 1, 100, 1000, 10000, 10000, '1000'),('2024-9-12 10:00:02', 2, 200, 2000, 20000, 20000, '2000'),('2024-9-12 10:00:03', 3, 300, 3000, 30000, 30000, '3000'),('2024-9-12 10:00:04', 4, 400, 4000, 40000, 40000, '4000'),('2024-9-12 10:00:05', 5, 500, 5000, 50000, 50000, '5000'),('2024-9-12 10:00:06', 6, 600, 6000, 60000, 60000, '6000'),('2024-9-12 10:00:07', 7, 700, 7000, 70000, 70000, '7000'),('2024-9-12 10:00:00', 8, 800, 8000, 80000, 80000, '8000'),('2024-9-12 10:00:02', 9, 900, 9000, 90000, 90000, '9000'),('2024-9-12 10:00:03', 10, 1000, 10000, 100000, 100000, '10000');
INSERT 10
> explain select distinct ptag1 from only_tag.table1;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select distinct ptag1, t1 from only_tag.table1;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select distinct ptag1, t1, t2 from only_tag.table1;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1, t2
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select distinct ptag1, t1, t2, t3 from only_tag.table1;
      tree     |    field    |    description
---------------+-------------+--------------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1, t2, t3
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select ptag1 from only_tag.table1 group by ptag1;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select ptag1, t1 from only_tag.table1 group by ptag1, t1;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select ptag1, t1, t2 from only_tag.table1 group by ptag1, t1, t2;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1, t2
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select ptag1, t1, t2, t3 from only_tag.table1 group by ptag1, t1, t2, t3;
      tree     |    field    |    description
---------------+-------------+--------------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1, t2, t3
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select ptag1, sum(t1) from only_tag.table1 group by ptag1;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  group        |             |
   │           | engine type | time series
   │           | aggregate 0 | ptag1
   │           | aggregate 1 | sum(t1)
   │           | group by    | ptag1
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(11 rows)
> explain select sum(t1) from only_tag.table1 group by ptag1;
        tree        |    field    |  description
--------------------+-------------+-----------------
                    | distributed | true
                    | vectorized  | false
  render            |             |
   │                | engine type | time series
   │                | sum         | sum
   └── group        |             |
        │           | engine type | time series
        │           | aggregate 0 | ptag1
        │           | aggregate 1 | sum(t1)
        │           | group by    | ptag1
        └── ts scan |             |
                    | ts-table    | table1
                    | only tag    | true
                    | access mode | tableTableMeta
(14 rows)
> explain select ptag1, t1, sum(t2) from only_tag.table1 group by ptag1, t1;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  group        |             |
   │           | engine type | time series
   │           | aggregate 0 | ptag1
   │           | aggregate 1 | t1
   │           | aggregate 2 | sum(t2)
   │           | group by    | ptag1, t1
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(12 rows)
> explain select ptag1, t1, t2, sum(t3) from only_tag.table1 group by ptag1, t1, t2;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  group        |             |
   │           | engine type | time series
   │           | aggregate 0 | ptag1
   │           | aggregate 1 | t1
   │           | aggregate 2 | t2
   │           | aggregate 3 | sum(t3)
   │           | group by    | ptag1, t1, t2
   └── ts scan |             |
               | ts-table    | table1
               | only tag    | true
               | access mode | tableTableMeta
(13 rows)
> explain select ptag1, sum(t1), sum(t2), sum(t3) from only_tag.table1 group by ptag1, t1, t2, t3;
        tree        |    field    |    description
--------------------+-------------+--------------------
                    | distributed | true
                    | vectorized  | false
  render            |             |
   │                | engine type | time series
   │                | ptag1       | ptag1
   │                | sum         | sum
   │                | sum         | sum
   │                | sum         | sum
   └── group        |             |
        │           | engine type | time series
        │           | aggregate 0 | ptag1
        │           | aggregate 1 | t1
        │           | aggregate 2 | t2
        │           | aggregate 3 | t3
        │           | aggregate 4 | sum(t1)
        │           | aggregate 5 | sum(t2)
        │           | aggregate 6 | sum(t3)
        │           | group by    | ptag1, t1, t2, t3
        └── ts scan |             |
                    | ts-table    | table1
                    | only tag    | true
                    | access mode | tableTableMeta
(22 rows)
> explain select ptag1 from only_tag.table1 where ptag1 = 100 group by ptag1;
      tree     |     field      | description
---------------+----------------+--------------
               | distributed    | true
               | vectorized     | false
  limit        |                |
   │           | engine type    | time series
   │           | count          | 1
   └── ts scan |                |
               | ts-table       | table1
               | only tag       | true
               | access mode    | tagIndex
               | ptag filter[0] | ptag1 = 100
(10 rows)
> explain select ptag1, t1 from only_tag.table1 where ptag1 = 100 group by ptag1, t1;
      tree     |     field      |  description
---------------+----------------+----------------
               | distributed    | true
               | vectorized     | false
  distinct     |                |
   │           | distinct on    | t1
   └── ts scan |                |
               | ts-table       | table1
               | only tag       | true
               | access mode    | tagIndexTable
               | ptag filter[0] | ptag1 = 100
(9 rows)
> explain select ptag1, t1, t2 from only_tag.table1 where ptag1 = 100 group by ptag1, t1, t2;
      tree     |     field      |  description
---------------+----------------+----------------
               | distributed    | true
               | vectorized     | false
  distinct     |                |
   │           | distinct on    | t1, t2
   └── ts scan |                |
               | ts-table       | table1
               | only tag       | true
               | access mode    | tagIndexTable
               | ptag filter[0] | ptag1 = 100
(9 rows)
> explain select ptag1, t1, t2, t3 from only_tag.table1 where ptag1 = 100 group by ptag1, t1, t2, t3;
      tree     |     field      |  description
---------------+----------------+----------------
               | distributed    | true
               | vectorized     | false
  distinct     |                |
   │           | distinct on    | t1, t2, t3
   └── ts scan |                |
               | ts-table       | table1
               | only tag       | true
               | access mode    | tagIndexTable
               | ptag filter[0] | ptag1 = 100
(9 rows)
> explain select ptag1 from only_tag.table1 where t1 > 1000 group by ptag1;
        tree        |     field     |  description
--------------------+---------------+-----------------
                    | distributed   | true
                    | vectorized    | false
  distinct          |               |
   │                | distinct on   | ptag1
   └── render       |               |
        │           | ptag1         | ptag1
        └── ts scan |               |
                    | ts-table      | table1
                    | only tag      | true
                    | access mode   | tableTableMeta
                    | tag filter[0] | t1 > 1000
(11 rows)
> explain select ptag1, t1 from only_tag.table1 where t1 > 1000 group by ptag1, t1;
      tree     |     field     |  description
---------------+---------------+-----------------
               | distributed   | true
               | vectorized    | false
  distinct     |               |
   │           | distinct on   | ptag1, t1
   └── ts scan |               |
               | ts-table      | table1
               | only tag      | true
               | access mode   | tableTableMeta
               | tag filter[0] | t1 > 1000
(9 rows)
> explain select ptag1, t1, t2 from only_tag.table1 where t1 > 1000 group by ptag1, t1, t2;
      tree     |     field     |  description
---------------+---------------+-----------------
               | distributed   | true
               | vectorized    | false
  distinct     |               |
   │           | distinct on   | ptag1, t1, t2
   └── ts scan |               |
               | ts-table      | table1
               | only tag      | true
               | access mode   | tableTableMeta
               | tag filter[0] | t1 > 1000
(9 rows)
> explain select ptag1, t1, t2, t3 from only_tag.table1 where t1 > 1000 group by ptag1, t1, t2, t3;
      tree     |     field     |    description
---------------+---------------+--------------------
               | distributed   | true
               | vectorized    | false
  distinct     |               |
   │           | distinct on   | ptag1, t1, t2, t3
   └── ts scan |               |
               | ts-table      | table1
               | only tag      | true
               | access mode   | tableTableMeta
               | tag filter[0] | t1 > 1000
(9 rows)
> explain select ptag1 from only_tag.table1 where ptag1 = 100 and t1 > 1000 group by ptag1;
        tree        |     field      |  description
--------------------+----------------+----------------
                    | distributed    | true
                    | vectorized     | false
  render            |                |
   │                | engine type    | time series
   │                | ptag1          | ptag1
   └── limit        |                |
        │           | engine type    | time series
        │           | count          | 1
        └── ts scan |                |
                    | ts-table       | table1
                    | only tag       | true
                    | access mode    | tagIndexTable
                    | tag filter[0]  | t1 > 1000
                    | ptag filter[0] | ptag1 = 100
(14 rows)
> explain select ptag1, t1 from only_tag.table1 where ptag1 = 100 and t1 > 1000 group by ptag1, t1;
      tree     |     field      |  description
---------------+----------------+----------------
               | distributed    | true
               | vectorized     | false
  distinct     |                |
   │           | distinct on    | t1
   └── ts scan |                |
               | ts-table       | table1
               | only tag       | true
               | access mode    | tagIndexTable
               | tag filter[0]  | t1 > 1000
               | ptag filter[0] | ptag1 = 100
(10 rows)
> explain select ptag1, t1, t2 from only_tag.table1 where ptag1 = 100 and t1 > 1000 group by ptag1, t1, t2;
      tree     |     field      |  description
---------------+----------------+----------------
               | distributed    | true
               | vectorized     | false
  distinct     |                |
   │           | distinct on    | t1, t2
   └── ts scan |                |
               | ts-table       | table1
               | only tag       | true
               | access mode    | tagIndexTable
               | tag filter[0]  | t1 > 1000
               | ptag filter[0] | ptag1 = 100
(10 rows)
> explain select ptag1, t1, t2, t3 from only_tag.table1 where ptag1 = 100 and t1 > 1000 group by ptag1, t1, t2, t3;
      tree     |     field      |  description
---------------+----------------+----------------
               | distributed    | true
               | vectorized     | false
  distinct     |                |
   │           | distinct on    | t1, t2, t3
   └── ts scan |                |
               | ts-table       | table1
               | only tag       | true
               | access mode    | tagIndexTable
               | tag filter[0]  | t1 > 1000
               | ptag filter[0] | ptag1 = 100
(10 rows)
> explain select ptag1, sum(t1+t2) from only_tag.table1 group by ptag1;
        tree        |    field    |  description
--------------------+-------------+-----------------
                    | distributed | true
                    | vectorized  | false
  group             |             |
   │                | engine type | time series
   │                | aggregate 0 | ptag1
   │                | aggregate 1 | sum(t1 + t2)
   │                | group by    | ptag1
   └── render       |             |
        │           | engine type | time series
        │           | t1 + t2     | t1 + t2
        │           | ptag1       | ptag1
        └── ts scan |             |
                    | ts-table    | table1
                    | only tag    | true
                    | access mode | tableTableMeta
(15 rows)
> explain select sum(t1+t2) from only_tag.table1 group by ptag1;
           tree          |    field    |  description
-------------------------+-------------+-----------------
                         | distributed | true
                         | vectorized  | false
  render                 |             |
   │                     | engine type | time series
   │                     | sum         | sum
   └── group             |             |
        │                | engine type | time series
        │                | aggregate 0 | ptag1
        │                | aggregate 1 | sum(t1 + t2)
        │                | group by    | ptag1
        └── render       |             |
             │           | engine type | time series
             │           | t1 + t2     | t1 + t2
             │           | ptag1       | ptag1
             └── ts scan |             |
                         | ts-table    | table1
                         | only tag    | true
                         | access mode | tableTableMeta
(18 rows)
> explain select ptag1, sum(t1+t2) from only_tag.table1 group by ptag1, t1;
           tree          |    field    |  description
-------------------------+-------------+-----------------
                         | distributed | true
                         | vectorized  | false
  render                 |             |
   │                     | engine type | time series
   │                     | ptag1       | ptag1
   │                     | sum         | sum
   └── group             |             |
        │                | engine type | time series
        │                | aggregate 0 | ptag1
        │                | aggregate 1 | t1
        │                | aggregate 2 | sum(t1 + t2)
        │                | group by    | ptag1, t1
        └── render       |             |
             │           | engine type | time series
             │           | t1 + t2     | t1 + t2
             │           | ptag1       | ptag1
             │           | t1          | t1
             └── ts scan |             |
                         | ts-table    | table1
                         | only tag    | true
                         | access mode | tableTableMeta
(21 rows)
> explain select ptag1, sum(t1+t2) from only_tag.table1 group by ptag1, t1, t2;
           tree          |    field    |  description
-------------------------+-------------+-----------------
                         | distributed | true
                         | vectorized  | false
  render                 |             |
   │                     | engine type | time series
   │                     | ptag1       | ptag1
   │                     | sum         | sum
   └── group             |             |
        │                | engine type | time series
        │                | aggregate 0 | ptag1
        │                | aggregate 1 | t1
        │                | aggregate 2 | t2
        │                | aggregate 3 | sum(t1 + t2)
        │                | group by    | ptag1, t1, t2
        └── render       |             |
             │           | engine type | time series
             │           | t1 + t2     | t1 + t2
             │           | ptag1       | ptag1
             │           | t1          | t1
             │           | t2          | t2
             └── ts scan |             |
                         | ts-table    | table1
                         | only tag    | true
                         | access mode | tableTableMeta
(23 rows)
> explain select ptag1, sum(t1+t2+t3) from only_tag.table1 group by ptag1, t1, t2, t3;
           tree          |     field      |     description
-------------------------+----------------+----------------------
                         | distributed    | true
                         | vectorized     | false
  render                 |                |
   │                     | ptag1          | ptag1
   │                     | sum            | sum
   └── group             |                |
        │                | aggregate 0    | ptag1
        │                | aggregate 1    | t1
        │                | aggregate 2    | t2
        │                | aggregate 3    | t3
        │                | aggregate 4    | sum((t1 + t2) + t3)
        │                | group by       | ptag1, t1, t2, t3
        └── render       |                |
             │           | (t1 + t2) + t3 | t3 + (t1 + t2)
             │           | ptag1          | ptag1
             │           | t1             | t1
             │           | t2             | t2
             │           | t3             | t3
             └── ts scan |                |
                         | ts-table       | table1
                         | only tag       | true
                         | access mode    | tableTableMeta
(22 rows)
> explain select sum(t1+t2) from only_tag.table1 group by ptag1 having sum(t1) > 3000;
             tree             |    field    |  description
------------------------------+-------------+-----------------
                              | distributed | true
                              | vectorized  | false
  render                      |             |
   │                          | engine type | time series
   │                          | sum         | sum
   └── filter                 |             |
        │                     | engine type | time series
        │                     | filter      | sum > 3000
        └── group             |             |
             │                | engine type | time series
             │                | aggregate 0 | ptag1
             │                | aggregate 1 | sum(t1 + t2)
             │                | aggregate 2 | sum(t1)
             │                | group by    | ptag1
             └── render       |             |
                  │           | engine type | time series
                  │           | t1 + t2     | t1 + t2
                  │           | ptag1       | ptag1
                  │           | t1          | t1
                  └── ts scan |             |
                              | ts-table    | table1
                              | only tag    | true
                              | access mode | tableTableMeta
(23 rows)
> explain select sum(t1+t2) from only_tag.table1 group by ptag1 having sum(t1) > 3000;
             tree             |    field    |  description
------------------------------+-------------+-----------------
                              | distributed | true
                              | vectorized  | false
  render                      |             |
   │                          | engine type | time series
   │                          | sum         | sum
   └── filter                 |             |
        │                     | engine type | time series
        │                     | filter      | sum > 3000
        └── group             |             |
             │                | engine type | time series
             │                | aggregate 0 | ptag1
             │                | aggregate 1 | sum(t1 + t2)
             │                | aggregate 2 | sum(t1)
             │                | group by    | ptag1
             └── render       |             |
                  │           | engine type | time series
                  │           | t1 + t2     | t1 + t2
                  │           | ptag1       | ptag1
                  │           | t1          | t1
                  └── ts scan |             |
                              | ts-table    | table1
                              | only tag    | true
                              | access mode | tableTableMeta
(23 rows)
> explain select sum(t1+t2) from only_tag.table1 group by ptag1, t1 having sum(t1) > 3000;
             tree             |    field    |  description
------------------------------+-------------+-----------------
                              | distributed | true
                              | vectorized  | false
  render                      |             |
   │                          | engine type | time series
   │                          | sum         | sum
   └── filter                 |             |
        │                     | engine type | time series
        │                     | filter      | sum > 3000
        └── group             |             |
             │                | engine type | time series
             │                | aggregate 0 | ptag1
             │                | aggregate 1 | t1
             │                | aggregate 2 | sum(t1 + t2)
             │                | aggregate 3 | sum(t1)
             │                | group by    | ptag1, t1
             └── render       |             |
                  │           | engine type | time series
                  │           | t1 + t2     | t1 + t2
                  │           | ptag1       | ptag1
                  │           | t1          | t1
                  └── ts scan |             |
                              | ts-table    | table1
                              | only tag    | true
                              | access mode | tableTableMeta
(24 rows)
> explain select sum(t1+t2) from only_tag.table1 group by ptag1, t1, t2 having sum(t1) > 3000;
             tree             |    field    |  description
------------------------------+-------------+-----------------
                              | distributed | true
                              | vectorized  | false
  render                      |             |
   │                          | engine type | time series
   │                          | sum         | sum
   └── filter                 |             |
        │                     | engine type | time series
        │                     | filter      | sum > 3000
        └── group             |             |
             │                | engine type | time series
             │                | aggregate 0 | ptag1
             │                | aggregate 1 | t1
             │                | aggregate 2 | t2
             │                | aggregate 3 | sum(t1 + t2)
             │                | aggregate 4 | sum(t1)
             │                | group by    | ptag1, t1, t2
             └── render       |             |
                  │           | engine type | time series
                  │           | t1 + t2     | t1 + t2
                  │           | ptag1       | ptag1
                  │           | t1          | t1
                  │           | t2          | t2
                  └── ts scan |             |
                              | ts-table    | table1
                              | only tag    | true
                              | access mode | tableTableMeta
(26 rows)
> explain select sum(t1+t2+t3) from only_tag.table1 group by ptag1, t1, t2, t3 having sum(t1) > 3000;
             tree             |     field      |     description
------------------------------+----------------+----------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | sum            | sum
   └── filter                 |                |
        │                     | filter         | sum > 3000
        └── group             |                |
             │                | aggregate 0    | ptag1
             │                | aggregate 1    | t1
             │                | aggregate 2    | t2
             │                | aggregate 3    | t3
             │                | aggregate 4    | sum((t1 + t2) + t3)
             │                | aggregate 5    | sum(t1)
             │                | group by       | ptag1, t1, t2, t3
             └── render       |                |
                  │           | (t1 + t2) + t3 | t3 + (t1 + t2)
                  │           | ptag1          | ptag1
                  │           | t1             | t1
                  │           | t2             | t2
                  │           | t3             | t3
                  └── ts scan |                |
                              | ts-table       | table1
                              | only tag       | true
                              | access mode    | tableTableMeta
(24 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table1 where ptag1 = 100 and t1 > 1000 group by ptag1 order by sm;
           tree          |     field      |     description
-------------------------+----------------+----------------------
                         | distributed    | true
                         | vectorized     | false
  render                 |                |
   │                     | engine type    | time series
   │                     | ptag1          | any_not_null
   │                     | sm             | sum
   └── group             |                |
        │                | engine type    | time series
        │                | aggregate 0    | sum(t1 + t2)
        │                | aggregate 1    | any_not_null(ptag1)
        └── render       |                |
             │           | engine type    | time series
             │           | t1 + t2        | t1 + t2
             │           | ptag1          | ptag1
             └── ts scan |                |
                         | ts-table       | table1
                         | only tag       | true
                         | access mode    | tagIndexTable
                         | tag filter[0]  | t1 > 1000
                         | ptag filter[0] | ptag1 = 100
(20 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table1 where ptag1 = 100 and t1 > 1000 group by ptag1, t1 order by sm;
             tree             |     field      |     description
------------------------------+----------------+----------------------
                              | distributed    | true
                              | vectorized     | false
  sort                        |                |
   │                          | order          | +sm
   └── render                 |                |
        │                     | engine type    | time series
        │                     | ptag1          | any_not_null
        │                     | sm             | sum
        └── group             |                |
             │                | engine type    | time series
             │                | aggregate 0    | t1
             │                | aggregate 1    | sum(t1 + t2)
             │                | aggregate 2    | any_not_null(ptag1)
             │                | group by       | t1
             └── render       |                |
                  │           | engine type    | time series
                  │           | t1 + t2        | t1 + t2
                  │           | ptag1          | ptag1
                  │           | t1             | t1
                  └── ts scan |                |
                              | ts-table       | table1
                              | only tag       | true
                              | access mode    | tagIndexTable
                              | tag filter[0]  | t1 > 1000
                              | ptag filter[0] | ptag1 = 100
(25 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table1 where ptag1 = 100 and t1 > 1000 group by ptag1, t1, t2 order by sm;
             tree             |     field      |     description
------------------------------+----------------+----------------------
                              | distributed    | true
                              | vectorized     | false
  sort                        |                |
   │                          | order          | +sm
   └── render                 |                |
        │                     | engine type    | time series
        │                     | ptag1          | any_not_null
        │                     | sm             | sum
        └── group             |                |
             │                | engine type    | time series
             │                | aggregate 0    | t1
             │                | aggregate 1    | t2
             │                | aggregate 2    | sum(t1 + t2)
             │                | aggregate 3    | any_not_null(ptag1)
             │                | group by       | t1, t2
             └── render       |                |
                  │           | engine type    | time series
                  │           | t1 + t2        | t1 + t2
                  │           | ptag1          | ptag1
                  │           | t1             | t1
                  │           | t2             | t2
                  └── ts scan |                |
                              | ts-table       | table1
                              | only tag       | true
                              | access mode    | tagIndexTable
                              | tag filter[0]  | t1 > 1000
                              | ptag filter[0] | ptag1 = 100
(27 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table1 where ptag1 = 100 and t1 > 1000 group by ptag1, t1, t2, t3 order by sm;
             tree             |     field      |     description
------------------------------+----------------+----------------------
                              | distributed    | true
                              | vectorized     | false
  sort                        |                |
   │                          | order          | +sm
   └── render                 |                |
        │                     | engine type    | time series
        │                     | ptag1          | any_not_null
        │                     | sm             | sum
        └── group             |                |
             │                | engine type    | time series
             │                | aggregate 0    | t1
             │                | aggregate 1    | t2
             │                | aggregate 2    | t3
             │                | aggregate 3    | sum(t1 + t2)
             │                | aggregate 4    | any_not_null(ptag1)
             │                | group by       | t1, t2, t3
             └── render       |                |
                  │           | engine type    | time series
                  │           | t1 + t2        | t1 + t2
                  │           | ptag1          | ptag1
                  │           | t1             | t1
                  │           | t2             | t2
                  │           | t3             | t3
                  └── ts scan |                |
                              | ts-table       | table1
                              | only tag       | true
                              | access mode    | tagIndexTable
                              | tag filter[0]  | t1 > 1000
                              | ptag filter[0] | ptag1 = 100
(29 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table1 where t1 > 1000 group by ptag1 order by sm limit 2 offset 1;
                tree               |     field     |  description
-----------------------------------+---------------+-----------------
                                   | distributed   | true
                                   | vectorized    | false
  limit                            |               |
   │                               | offset        | 1
   └── limit                       |               |
        │                          | engine type   | time series
        │                          | count         | 3
        └── sort                   |               |
             │                     | order         | +sm
             └── group             |               |
                  │                | engine type   | time series
                  │                | aggregate 0   | ptag1
                  │                | aggregate 1   | sum(t1 + t2)
                  │                | group by      | ptag1
                  └── render       |               |
                       │           | engine type   | time series
                       │           | t1 + t2       | t1 + t2
                       │           | ptag1         | ptag1
                       └── ts scan |               |
                                   | ts-table      | table1
                                   | only tag      | true
                                   | access mode   | tableTableMeta
                                   | tag filter[0] | t1 > 1000
(23 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table1 where t1 > 1000 group by ptag1, t1 order by sm limit 2 offset 1;
                  tree                  |     field     |  description
----------------------------------------+---------------+-----------------
                                        | distributed   | true
                                        | vectorized    | false
  render                                |               |
   │                                    | ptag1         | ptag1
   │                                    | sm            | sum
   └── limit                            |               |
        │                               | offset        | 1
        └── limit                       |               |
             │                          | engine type   | time series
             │                          | count         | 3
             └── sort                   |               |
                  │                     | order         | +sum
                  └── group             |               |
                       │                | engine type   | time series
                       │                | aggregate 0   | ptag1
                       │                | aggregate 1   | t1
                       │                | aggregate 2   | sum(t1 + t2)
                       │                | group by      | ptag1, t1
                       └── render       |               |
                            │           | engine type   | time series
                            │           | t1 + t2       | t1 + t2
                            │           | ptag1         | ptag1
                            │           | t1            | t1
                            └── ts scan |               |
                                        | ts-table      | table1
                                        | only tag      | true
                                        | access mode   | tableTableMeta
                                        | tag filter[0] | t1 > 1000
(28 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table1 where t1 > 1000 group by ptag1, t1, t2 order by sm limit 2 offset 1;
                  tree                  |     field     |  description
----------------------------------------+---------------+-----------------
                                        | distributed   | true
                                        | vectorized    | false
  render                                |               |
   │                                    | ptag1         | ptag1
   │                                    | sm            | sum
   └── limit                            |               |
        │                               | offset        | 1
        └── limit                       |               |
             │                          | engine type   | time series
             │                          | count         | 3
             └── sort                   |               |
                  │                     | order         | +sum
                  └── group             |               |
                       │                | engine type   | time series
                       │                | aggregate 0   | ptag1
                       │                | aggregate 1   | t1
                       │                | aggregate 2   | t2
                       │                | aggregate 3   | sum(t1 + t2)
                       │                | group by      | ptag1, t1, t2
                       └── render       |               |
                            │           | engine type   | time series
                            │           | t1 + t2       | t1 + t2
                            │           | ptag1         | ptag1
                            │           | t1            | t1
                            │           | t2            | t2
                            └── ts scan |               |
                                        | ts-table      | table1
                                        | only tag      | true
                                        | access mode   | tableTableMeta
                                        | tag filter[0] | t1 > 1000
(30 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table1 where t1 > 1000 group by ptag1, t1, t2, t3 order by sm limit 2 offset 1;
                  tree                  |     field     |    description
----------------------------------------+---------------+--------------------
                                        | distributed   | true
                                        | vectorized    | false
  render                                |               |
   │                                    | ptag1         | ptag1
   │                                    | sm            | sum
   └── limit                            |               |
        │                               | offset        | 1
        └── limit                       |               |
             │                          | engine type   | time series
             │                          | count         | 3
             └── sort                   |               |
                  │                     | order         | +sum
                  └── group             |               |
                       │                | engine type   | time series
                       │                | aggregate 0   | ptag1
                       │                | aggregate 1   | t1
                       │                | aggregate 2   | t2
                       │                | aggregate 3   | t3
                       │                | aggregate 4   | sum(t1 + t2)
                       │                | group by      | ptag1, t1, t2, t3
                       └── render       |               |
                            │           | engine type   | time series
                            │           | t1 + t2       | t1 + t2
                            │           | ptag1         | ptag1
                            │           | t1            | t1
                            │           | t2            | t2
                            │           | t3            | t3
                            └── ts scan |               |
                                        | ts-table      | table1
                                        | only tag      | true
                                        | access mode   | tableTableMeta
                                        | tag filter[0] | t1 > 1000
(32 rows)
> explain select distinct ptag1 from only_tag.table2;
        tree        |    field    |  description
--------------------+-------------+-----------------
                    | distributed | true
                    | vectorized  | false
  distinct          |             |
   │                | distinct on | ptag1
   └── synchronizer |             |
        └── ts scan |             |
                    | ts-table    | table2
                    | access mode | tableTableMeta
(8 rows)
> explain select distinct ptag1, t1 from only_tag.table2;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1
   └── ts scan |             |
               | ts-table    | table2
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select distinct ptag1, t1, t2 from only_tag.table2;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1, t2
   └── ts scan |             |
               | ts-table    | table2
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select distinct ptag1, t1, t2, t3 from only_tag.table2;
      tree     |    field    |    description
---------------+-------------+--------------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1, t2, t3
   └── ts scan |             |
               | ts-table    | table2
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select ptag1 from only_tag.table2 group by ptag1;
        tree        |    field    |  description
--------------------+-------------+-----------------
                    | distributed | true
                    | vectorized  | false
  distinct          |             |
   │                | distinct on | ptag1
   └── synchronizer |             |
        └── ts scan |             |
                    | ts-table    | table2
                    | access mode | tableTableMeta
(8 rows)
> explain select ptag1, t1 from only_tag.table2 group by ptag1, t1;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1
   └── ts scan |             |
               | ts-table    | table2
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select ptag1, t1, t2 from only_tag.table2 group by ptag1, t1, t2;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1, t2
   └── ts scan |             |
               | ts-table    | table2
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select ptag1, t1, t2, t3 from only_tag.table2 group by ptag1, t1, t2, t3;
      tree     |    field    |    description
---------------+-------------+--------------------
               | distributed | true
               | vectorized  | false
  distinct     |             |
   │           | distinct on | ptag1, t1, t2, t3
   └── ts scan |             |
               | ts-table    | table2
               | only tag    | true
               | access mode | tableTableMeta
(8 rows)
> explain select ptag1, sum(t1) from only_tag.table2 group by ptag1;
      tree     |      field       |  description
---------------+------------------+-----------------
               | distributed      | true
               | vectorized       | false
  group        |                  |
   │           | engine type      | time series
   │           | aggregate 0      | ptag1
   │           | aggregate 1      | sum(t1)
   │           | group by         | ptag1
   │           | addSynchronizer  | true
   └── ts scan |                  |
               | ts-table         | table2
               | access mode      | tableTableMeta
(11 rows)
> explain select ptag1, t1, sum(t2) from only_tag.table2 group by ptag1, t1;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  group        |             |
   │           | engine type | time series
   │           | aggregate 0 | ptag1
   │           | aggregate 1 | t1
   │           | aggregate 2 | sum(t2)
   │           | group by    | ptag1, t1
   └── ts scan |             |
               | ts-table    | table2
               | only tag    | true
               | access mode | tableTableMeta
(12 rows)
> explain select ptag1, t1, t2, sum(t3) from only_tag.table2 group by ptag1, t1, t2;
      tree     |    field    |  description
---------------+-------------+-----------------
               | distributed | true
               | vectorized  | false
  group        |             |
   │           | engine type | time series
   │           | aggregate 0 | ptag1
   │           | aggregate 1 | t1
   │           | aggregate 2 | t2
   │           | aggregate 3 | sum(t3)
   │           | group by    | ptag1, t1, t2
   └── ts scan |             |
               | ts-table    | table2
               | only tag    | true
               | access mode | tableTableMeta
(13 rows)
> explain select ptag1, sum(t1), sum(t2), sum(t3) from only_tag.table2 group by ptag1, t1, t2, t3;
        tree        |    field    |    description
--------------------+-------------+--------------------
                    | distributed | true
                    | vectorized  | false
  render            |             |
   │                | engine type | time series
   │                | ptag1       | ptag1
   │                | sum         | sum
   │                | sum         | sum
   │                | sum         | sum
   └── group        |             |
        │           | engine type | time series
        │           | aggregate 0 | ptag1
        │           | aggregate 1 | t1
        │           | aggregate 2 | t2
        │           | aggregate 3 | t3
        │           | aggregate 4 | sum(t1)
        │           | aggregate 5 | sum(t2)
        │           | aggregate 6 | sum(t3)
        │           | group by    | ptag1, t1, t2, t3
        └── ts scan |             |
                    | ts-table    | table2
                    | only tag    | true
                    | access mode | tableTableMeta
(22 rows)
> explain select ptag1 from only_tag.table2 where ptag1 = 100 group by ptag1;
           tree          |     field     |  description
-------------------------+---------------+-----------------
                         | distributed   | true
                         | vectorized    | false
  limit                  |               |
   │                     | engine type   | time series
   │                     | count         | 1
   └── synchronizer      |               |
        └── limit        |               |
             │           | engine type   | time series
             │           | count         | 1
             └── ts scan |               |
                         | ts-table      | table2
                         | access mode   | tableTableMeta
                         | tag filter[0] | ptag1 = 100
(13 rows)
> explain select ptag1, t1 from only_tag.table2 where ptag1 = 100 group by ptag1, t1;
      tree     |     field     |  description
---------------+---------------+-----------------
               | distributed   | true
               | vectorized    | false
  distinct     |               |
   │           | distinct on   | t1
   └── ts scan |               |
               | ts-table      | table2
               | only tag      | true
               | access mode   | tableTableMeta
               | tag filter[0] | ptag1 = 100
(9 rows)
> explain select ptag1, t1, t2 from only_tag.table2 where ptag1 = 100 group by ptag1, t1, t2;
      tree     |     field     |  description
---------------+---------------+-----------------
               | distributed   | true
               | vectorized    | false
  distinct     |               |
   │           | distinct on   | t1, t2
   └── ts scan |               |
               | ts-table      | table2
               | only tag      | true
               | access mode   | tableTableMeta
               | tag filter[0] | ptag1 = 100
(9 rows)
> explain select ptag1, t1, t2, t3 from only_tag.table2 where ptag1 = 100 group by ptag1, t1, t2, t3;
      tree     |     field     |  description
---------------+---------------+-----------------
               | distributed   | true
               | vectorized    | false
  distinct     |               |
   │           | distinct on   | t1, t2, t3
   └── ts scan |               |
               | ts-table      | table2
               | only tag      | true
               | access mode   | tableTableMeta
               | tag filter[0] | ptag1 = 100
(9 rows)
> explain select ptag1 from only_tag.table2 where ptag1 = 100 and t1 > 1000 group by ptag1;
             tree             |     field     |  description
------------------------------+---------------+-----------------
                              | distributed   | true
                              | vectorized    | false
  render                      |               |
   │                          | engine type   | time series
   │                          | ptag1         | ptag1
   └── limit                  |               |
        │                     | engine type   | time series
        │                     | count         | 1
        └── synchronizer      |               |
             └── limit        |               |
                  │           | engine type   | time series
                  │           | count         | 1
                  └── ts scan |               |
                              | ts-table      | table2
                              | access mode   | tableTableMeta
                              | tag filter[0] | t1 > 1000
                              | tag filter[1] | ptag1 = 100
(17 rows)
> explain select ptag1, t1 from only_tag.table2 where ptag1 = 100 and t1 > 1000 group by ptag1, t1;
      tree     |     field     |  description
---------------+---------------+-----------------
               | distributed   | true
               | vectorized    | false
  distinct     |               |
   │           | distinct on   | t1
   └── ts scan |               |
               | ts-table      | table2
               | only tag      | true
               | access mode   | tableTableMeta
               | tag filter[0] | t1 > 1000
               | tag filter[1] | ptag1 = 100
(10 rows)
> explain select ptag1, t1, t2 from only_tag.table2 where ptag1 = 100 and t1 > 1000 group by ptag1, t1, t2;
      tree     |     field     |  description
---------------+---------------+-----------------
               | distributed   | true
               | vectorized    | false
  distinct     |               |
   │           | distinct on   | t1, t2
   └── ts scan |               |
               | ts-table      | table2
               | only tag      | true
               | access mode   | tableTableMeta
               | tag filter[0] | t1 > 1000
               | tag filter[1] | ptag1 = 100
(10 rows)
> explain select ptag1, t1, t2, t3 from only_tag.table2 where ptag1 = 100 and t1 > 1000 group by ptag1, t1, t2, t3;
      tree     |     field     |  description
---------------+---------------+-----------------
               | distributed   | true
               | vectorized    | false
  distinct     |               |
   │           | distinct on   | t1, t2, t3
   └── ts scan |               |
               | ts-table      | table2
               | only tag      | true
               | access mode   | tableTableMeta
               | tag filter[0] | t1 > 1000
               | tag filter[1] | ptag1 = 100
(10 rows)
> explain select ptag1, sum(t1+t2) from only_tag.table2 group by ptag1;
        tree        |      field       |  description
--------------------+------------------+-----------------
                    | distributed      | true
                    | vectorized       | false
  group             |                  |
   │                | engine type      | time series
   │                | aggregate 0      | ptag1
   │                | aggregate 1      | sum(t1 + t2)
   │                | group by         | ptag1
   │                | addSynchronizer  | true
   └── render       |                  |
        │           | engine type      | time series
        │           | t1 + t2          | t1 + t2
        │           | ptag1            | ptag1
        └── ts scan |                  |
                    | ts-table         | table2
                    | access mode      | tableTableMeta
(15 rows)
> explain select ptag1, sum(t1+t2) from only_tag.table2 group by ptag1, t1;
           tree          |    field    |  description
-------------------------+-------------+-----------------
                         | distributed | true
                         | vectorized  | false
  render                 |             |
   │                     | engine type | time series
   │                     | ptag1       | ptag1
   │                     | sum         | sum
   └── group             |             |
        │                | engine type | time series
        │                | aggregate 0 | ptag1
        │                | aggregate 1 | t1
        │                | aggregate 2 | sum(t1 + t2)
        │                | group by    | ptag1, t1
        └── render       |             |
             │           | engine type | time series
             │           | t1 + t2     | t1 + t2
             │           | ptag1       | ptag1
             │           | t1          | t1
             └── ts scan |             |
                         | ts-table    | table2
                         | only tag    | true
                         | access mode | tableTableMeta
(21 rows)
> explain select ptag1, sum(t1+t2) from only_tag.table2 group by ptag1, t1, t2;
           tree          |    field    |  description
-------------------------+-------------+-----------------
                         | distributed | true
                         | vectorized  | false
  render                 |             |
   │                     | engine type | time series
   │                     | ptag1       | ptag1
   │                     | sum         | sum
   └── group             |             |
        │                | engine type | time series
        │                | aggregate 0 | ptag1
        │                | aggregate 1 | t1
        │                | aggregate 2 | t2
        │                | aggregate 3 | sum(t1 + t2)
        │                | group by    | ptag1, t1, t2
        └── render       |             |
             │           | engine type | time series
             │           | t1 + t2     | t1 + t2
             │           | ptag1       | ptag1
             │           | t1          | t1
             │           | t2          | t2
             └── ts scan |             |
                         | ts-table    | table2
                         | only tag    | true
                         | access mode | tableTableMeta
(23 rows)
> explain select ptag1, sum(t1+t2+t3) from only_tag.table2 group by ptag1, t1, t2, t3;
           tree          |     field      |     description
-------------------------+----------------+----------------------
                         | distributed    | true
                         | vectorized     | false
  render                 |                |
   │                     | ptag1          | ptag1
   │                     | sum            | sum
   └── group             |                |
        │                | aggregate 0    | ptag1
        │                | aggregate 1    | t1
        │                | aggregate 2    | t2
        │                | aggregate 3    | t3
        │                | aggregate 4    | sum((t1 + t2) + t3)
        │                | group by       | ptag1, t1, t2, t3
        └── render       |                |
             │           | (t1 + t2) + t3 | t3 + (t1 + t2)
             │           | ptag1          | ptag1
             │           | t1             | t1
             │           | t2             | t2
             │           | t3             | t3
             └── ts scan |                |
                         | ts-table       | table2
                         | only tag       | true
                         | access mode    | tableTableMeta
(22 rows)
> explain select ptag1, sum(t1+t2) from only_tag.table2 group by ptag1 having sum(t1) > 3000;
             tree             |      field       |  description
------------------------------+------------------+-----------------
                              | distributed      | true
                              | vectorized       | false
  render                      |                  |
   │                          | engine type      | time series
   │                          | ptag1            | ptag1
   │                          | sum              | sum
   └── filter                 |                  |
        │                     | engine type      | time series
        │                     | filter           | sum > 3000
        └── group             |                  |
             │                | engine type      | time series
             │                | aggregate 0      | ptag1
             │                | aggregate 1      | sum(t1 + t2)
             │                | aggregate 2      | sum(t1)
             │                | group by         | ptag1
             │                | addSynchronizer  | true
             └── render       |                  |
                  │           | engine type      | time series
                  │           | t1 + t2          | t1 + t2
                  │           | ptag1            | ptag1
                  │           | t1               | t1
                  └── ts scan |                  |
                              | ts-table         | table2
                              | access mode      | tableTableMeta
(24 rows)
> explain select sum(t1+t2) from only_tag.table2 group by ptag1 having sum(t1) > 3000;
             tree             |      field       |  description
------------------------------+------------------+-----------------
                              | distributed      | true
                              | vectorized       | false
  render                      |                  |
   │                          | engine type      | time series
   │                          | sum              | sum
   └── filter                 |                  |
        │                     | engine type      | time series
        │                     | filter           | sum > 3000
        └── group             |                  |
             │                | engine type      | time series
             │                | aggregate 0      | ptag1
             │                | aggregate 1      | sum(t1 + t2)
             │                | aggregate 2      | sum(t1)
             │                | group by         | ptag1
             │                | addSynchronizer  | true
             └── render       |                  |
                  │           | engine type      | time series
                  │           | t1 + t2          | t1 + t2
                  │           | ptag1            | ptag1
                  │           | t1               | t1
                  └── ts scan |                  |
                              | ts-table         | table2
                              | access mode      | tableTableMeta
(23 rows)
> explain select ptag1, sum(t1+t2) from only_tag.table2 group by ptag1, t1 having sum(t1) > 3000;
             tree             |    field    |  description
------------------------------+-------------+-----------------
                              | distributed | true
                              | vectorized  | false
  render                      |             |
   │                          | engine type | time series
   │                          | ptag1       | ptag1
   │                          | sum         | sum
   └── filter                 |             |
        │                     | engine type | time series
        │                     | filter      | sum > 3000
        └── group             |             |
             │                | engine type | time series
             │                | aggregate 0 | ptag1
             │                | aggregate 1 | t1
             │                | aggregate 2 | sum(t1 + t2)
             │                | aggregate 3 | sum(t1)
             │                | group by    | ptag1, t1
             └── render       |             |
                  │           | engine type | time series
                  │           | t1 + t2     | t1 + t2
                  │           | ptag1       | ptag1
                  │           | t1          | t1
                  └── ts scan |             |
                              | ts-table    | table2
                              | only tag    | true
                              | access mode | tableTableMeta
(25 rows)
> explain select ptag1, sum(t1+t2) from only_tag.table2 group by ptag1, t1, t2 having sum(t1) > 3000;
             tree             |    field    |  description
------------------------------+-------------+-----------------
                              | distributed | true
                              | vectorized  | false
  render                      |             |
   │                          | engine type | time series
   │                          | ptag1       | ptag1
   │                          | sum         | sum
   └── filter                 |             |
        │                     | engine type | time series
        │                     | filter      | sum > 3000
        └── group             |             |
             │                | engine type | time series
             │                | aggregate 0 | ptag1
             │                | aggregate 1 | t1
             │                | aggregate 2 | t2
             │                | aggregate 3 | sum(t1 + t2)
             │                | aggregate 4 | sum(t1)
             │                | group by    | ptag1, t1, t2
             └── render       |             |
                  │           | engine type | time series
                  │           | t1 + t2     | t1 + t2
                  │           | ptag1       | ptag1
                  │           | t1          | t1
                  │           | t2          | t2
                  └── ts scan |             |
                              | ts-table    | table2
                              | only tag    | true
                              | access mode | tableTableMeta
(27 rows)
> explain select ptag1, sum(t1+t2+t3) from only_tag.table2 group by ptag1, t1, t2, t3 having sum(t1) > 3000;
             tree             |     field      |     description
------------------------------+----------------+----------------------
                              | distributed    | true
                              | vectorized     | false
  render                      |                |
   │                          | ptag1          | ptag1
   │                          | sum            | sum
   └── filter                 |                |
        │                     | filter         | sum > 3000
        └── group             |                |
             │                | aggregate 0    | ptag1
             │                | aggregate 1    | t1
             │                | aggregate 2    | t2
             │                | aggregate 3    | t3
             │                | aggregate 4    | sum((t1 + t2) + t3)
             │                | aggregate 5    | sum(t1)
             │                | group by       | ptag1, t1, t2, t3
             └── render       |                |
                  │           | (t1 + t2) + t3 | t3 + (t1 + t2)
                  │           | ptag1          | ptag1
                  │           | t1             | t1
                  │           | t2             | t2
                  │           | t3             | t3
                  └── ts scan |                |
                              | ts-table       | table2
                              | only tag       | true
                              | access mode    | tableTableMeta
(25 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table2 where ptag1 = 100 and t1 > 1000 group by ptag1 order by sm;
           tree          |      field       |     description
-------------------------+------------------+----------------------
                         | distributed      | true
                         | vectorized       | false
  render                 |                  |
   │                     | engine type      | time series
   │                     | ptag1            | any_not_null
   │                     | sm               | sum
   └── group             |                  |
        │                | engine type      | time series
        │                | aggregate 0      | sum(t1 + t2)
        │                | aggregate 1      | any_not_null(ptag1)
        │                | addSynchronizer  | true
        └── render       |                  |
             │           | engine type      | time series
             │           | t1 + t2          | t1 + t2
             │           | ptag1            | ptag1
             └── ts scan |                  |
                         | ts-table         | table2
                         | access mode      | tableTableMeta
                         | tag filter[0]    | t1 > 1000
                         | tag filter[1]    | ptag1 = 100
(20 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table2 where ptag1 = 100 and t1 > 1000 group by ptag1, t1 order by sm;
             tree             |     field     |     description
------------------------------+---------------+----------------------
                              | distributed   | true
                              | vectorized    | false
  sort                        |               |
   │                          | order         | +sm
   └── render                 |               |
        │                     | engine type   | time series
        │                     | ptag1         | any_not_null
        │                     | sm            | sum
        └── group             |               |
             │                | engine type   | time series
             │                | aggregate 0   | t1
             │                | aggregate 1   | sum(t1 + t2)
             │                | aggregate 2   | any_not_null(ptag1)
             │                | group by      | t1
             └── render       |               |
                  │           | engine type   | time series
                  │           | t1 + t2       | t1 + t2
                  │           | ptag1         | ptag1
                  │           | t1            | t1
                  └── ts scan |               |
                              | ts-table      | table2
                              | only tag      | true
                              | access mode   | tableTableMeta
                              | tag filter[0] | t1 > 1000
                              | tag filter[1] | ptag1 = 100
(25 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table2 where ptag1 = 100 and t1 > 1000 group by ptag1, t1, t2 order by sm;
             tree             |     field     |     description
------------------------------+---------------+----------------------
                              | distributed   | true
                              | vectorized    | false
  sort                        |               |
   │                          | order         | +sm
   └── render                 |               |
        │                     | engine type   | time series
        │                     | ptag1         | any_not_null
        │                     | sm            | sum
        └── group             |               |
             │                | engine type   | time series
             │                | aggregate 0   | t1
             │                | aggregate 1   | t2
             │                | aggregate 2   | sum(t1 + t2)
             │                | aggregate 3   | any_not_null(ptag1)
             │                | group by      | t1, t2
             └── render       |               |
                  │           | engine type   | time series
                  │           | t1 + t2       | t1 + t2
                  │           | ptag1         | ptag1
                  │           | t1            | t1
                  │           | t2            | t2
                  └── ts scan |               |
                              | ts-table      | table2
                              | only tag      | true
                              | access mode   | tableTableMeta
                              | tag filter[0] | t1 > 1000
                              | tag filter[1] | ptag1 = 100
(27 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table2 where ptag1 = 100 and t1 > 1000 group by ptag1, t1, t2, t3 order by sm;
             tree             |     field     |     description
------------------------------+---------------+----------------------
                              | distributed   | true
                              | vectorized    | false
  sort                        |               |
   │                          | order         | +sm
   └── render                 |               |
        │                     | engine type   | time series
        │                     | ptag1         | any_not_null
        │                     | sm            | sum
        └── group             |               |
             │                | engine type   | time series
             │                | aggregate 0   | t1
             │                | aggregate 1   | t2
             │                | aggregate 2   | t3
             │                | aggregate 3   | sum(t1 + t2)
             │                | aggregate 4   | any_not_null(ptag1)
             │                | group by      | t1, t2, t3
             └── render       |               |
                  │           | engine type   | time series
                  │           | t1 + t2       | t1 + t2
                  │           | ptag1         | ptag1
                  │           | t1            | t1
                  │           | t2            | t2
                  │           | t3            | t3
                  └── ts scan |               |
                              | ts-table      | table2
                              | only tag      | true
                              | access mode   | tableTableMeta
                              | tag filter[0] | t1 > 1000
                              | tag filter[1] | ptag1 = 100
(29 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table2 where t1 > 1000 group by ptag1 order by sm limit 2 offset 1;
                tree               |      field       |  description
-----------------------------------+------------------+-----------------
                                   | distributed      | true
                                   | vectorized       | false
  limit                            |                  |
   │                               | offset           | 1
   └── limit                       |                  |
        │                          | engine type      | time series
        │                          | count            | 3
        └── sort                   |                  |
             │                     | order            | +sm
             └── group             |                  |
                  │                | engine type      | time series
                  │                | aggregate 0      | ptag1
                  │                | aggregate 1      | sum(t1 + t2)
                  │                | group by         | ptag1
                  │                | addSynchronizer  | true
                  └── render       |                  |
                       │           | engine type      | time series
                       │           | t1 + t2          | t1 + t2
                       │           | ptag1            | ptag1
                       └── ts scan |                  |
                                   | ts-table         | table2
                                   | access mode      | tableTableMeta
                                   | tag filter[0]    | t1 > 1000
(23 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table2 where t1 > 1000 group by ptag1, t1 order by sm limit 2 offset 1;
                  tree                  |     field     |  description
----------------------------------------+---------------+-----------------
                                        | distributed   | true
                                        | vectorized    | false
  render                                |               |
   │                                    | ptag1         | ptag1
   │                                    | sm            | sum
   └── limit                            |               |
        │                               | offset        | 1
        └── limit                       |               |
             │                          | engine type   | time series
             │                          | count         | 3
             └── sort                   |               |
                  │                     | order         | +sum
                  └── group             |               |
                       │                | engine type   | time series
                       │                | aggregate 0   | ptag1
                       │                | aggregate 1   | t1
                       │                | aggregate 2   | sum(t1 + t2)
                       │                | group by      | ptag1, t1
                       └── render       |               |
                            │           | engine type   | time series
                            │           | t1 + t2       | t1 + t2
                            │           | ptag1         | ptag1
                            │           | t1            | t1
                            └── ts scan |               |
                                        | ts-table      | table2
                                        | only tag      | true
                                        | access mode   | tableTableMeta
                                        | tag filter[0] | t1 > 1000
(28 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table2 where t1 > 1000 group by ptag1, t1, t2 order by sm limit 2 offset 1;
                  tree                  |     field     |  description
----------------------------------------+---------------+-----------------
                                        | distributed   | true
                                        | vectorized    | false
  render                                |               |
   │                                    | ptag1         | ptag1
   │                                    | sm            | sum
   └── limit                            |               |
        │                               | offset        | 1
        └── limit                       |               |
             │                          | engine type   | time series
             │                          | count         | 3
             └── sort                   |               |
                  │                     | order         | +sum
                  └── group             |               |
                       │                | engine type   | time series
                       │                | aggregate 0   | ptag1
                       │                | aggregate 1   | t1
                       │                | aggregate 2   | t2
                       │                | aggregate 3   | sum(t1 + t2)
                       │                | group by      | ptag1, t1, t2
                       └── render       |               |
                            │           | engine type   | time series
                            │           | t1 + t2       | t1 + t2
                            │           | ptag1         | ptag1
                            │           | t1            | t1
                            │           | t2            | t2
                            └── ts scan |               |
                                        | ts-table      | table2
                                        | only tag      | true
                                        | access mode   | tableTableMeta
                                        | tag filter[0] | t1 > 1000
(30 rows)
> explain select ptag1, sum(t1+t2) as sm from only_tag.table2 where t1 > 1000 group by ptag1, t1, t2, t3 order by sm limit 2 offset 1;
                  tree                  |     field     |    description
----------------------------------------+---------------+--------------------
                                        | distributed   | true
                                        | vectorized    | false
  render                                |               |
   │                                    | ptag1         | ptag1
   │                                    | sm            | sum
   └── limit                            |               |
        │                               | offset        | 1
        └── limit                       |               |
             │                          | engine type   | time series
             │                          | count         | 3
             └── sort                   |               |
                  │                     | order         | +sum
                  └── group             |               |
                       │                | engine type   | time series
                       │                | aggregate 0   | ptag1
                       │                | aggregate 1   | t1
                       │                | aggregate 2   | t2
                       │                | aggregate 3   | t3
                       │                | aggregate 4   | sum(t1 + t2)
                       │                | group by      | ptag1, t1, t2, t3
                       └── render       |               |
                            │           | engine type   | time series
                            │           | t1 + t2       | t1 + t2
                            │           | ptag1         | ptag1
                            │           | t1            | t1
                            │           | t2            | t2
                            │           | t3            | t3
                            └── ts scan |               |
                                        | ts-table      | table2
                                        | only tag      | true
                                        | access mode   | tableTableMeta
                                        | tag filter[0] | t1 > 1000
(32 rows)
> select distinct ptag1 from only_tag.table1 ORDER by ptag1;
  ptag1
---------
    100
    200
    300
    400
    500
    600
    700
(7 rows)
> select distinct ptag1, t1 from only_tag.table1 ORDER by ptag1;
  ptag1 |  t1
--------+-------
    100 | 1000
    200 | 2000
    300 | 3000
    400 | 4000
    500 | 5000
    600 | 6000
    700 | 7000
(7 rows)
> select distinct ptag1, t1, t2 from only_tag.table1 ORDER by ptag1;
  ptag1 |  t1  |  t2
--------+------+--------
    100 | 1000 | 10000
    200 | 2000 | 20000
    300 | 3000 | 30000
    400 | 4000 | 40000
    500 | 5000 | 50000
    600 | 6000 | 60000
    700 | 7000 | 70000
(7 rows)
> select distinct ptag1, t1, t2, t3 from only_tag.table1 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  t3
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
    200 | 2000 | 20000 | 20000
    300 | 3000 | 30000 | 30000
    400 | 4000 | 40000 | 40000
    500 | 5000 | 50000 | 50000
    600 | 6000 | 60000 | 60000
    700 | 7000 | 70000 | 70000
(7 rows)
> select ptag1 from only_tag.table1 group by ptag1 ORDER by ptag1;
  ptag1
---------
    100
    200
    300
    400
    500
    600
    700
(7 rows)
> select ptag1, t1 from only_tag.table1 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  t1
--------+-------
    100 | 1000
    200 | 2000
    300 | 3000
    400 | 4000
    500 | 5000
    600 | 6000
    700 | 7000
(7 rows)
> select ptag1, t1, t2 from only_tag.table1 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  t1  |  t2
--------+------+--------
    100 | 1000 | 10000
    200 | 2000 | 20000
    300 | 3000 | 30000
    400 | 4000 | 40000
    500 | 5000 | 50000
    600 | 6000 | 60000
    700 | 7000 | 70000
(7 rows)
> select ptag1, t1, t2, t3 from only_tag.table1 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  t3
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
    200 | 2000 | 20000 | 20000
    300 | 3000 | 30000 | 30000
    400 | 4000 | 40000 | 40000
    500 | 5000 | 50000 | 50000
    600 | 6000 | 60000 | 60000
    700 | 7000 | 70000 | 70000
(7 rows)
> select ptag1, sum(t1) from only_tag.table1 group by ptag1 ORDER by ptag1;
  ptag1 | sum
--------+-------
    100 | 1000
    200 | 2000
    300 | 3000
    400 | 4000
    500 | 5000
    600 | 6000
    700 | 7000
(7 rows)
> select ptag1, t1, sum(t2) from only_tag.table1 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  t1  |  sum
--------+------+--------
    100 | 1000 | 10000
    200 | 2000 | 20000
    300 | 3000 | 30000
    400 | 4000 | 40000
    500 | 5000 | 50000
    600 | 6000 | 60000
    700 | 7000 | 70000
(7 rows)
> select ptag1, t1, t2, sum(t3) from only_tag.table1 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  sum
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
    200 | 2000 | 20000 | 20000
    300 | 3000 | 30000 | 30000
    400 | 4000 | 40000 | 40000
    500 | 5000 | 50000 | 50000
    600 | 6000 | 60000 | 60000
    700 | 7000 | 70000 | 70000
(7 rows)
> select ptag1, sum(t1), sum(t2), sum(t3) from only_tag.table1 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 | sum  |  sum  |  sum
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
    200 | 2000 | 20000 | 20000
    300 | 3000 | 30000 | 30000
    400 | 4000 | 40000 | 40000
    500 | 5000 | 50000 | 50000
    600 | 6000 | 60000 | 60000
    700 | 7000 | 70000 | 70000
(7 rows)
> select ptag1 from only_tag.table1 where ptag1 = 100 group by ptag1 ORDER by ptag1;
  ptag1
---------
    100
(1 row)
> select ptag1, t1 from only_tag.table1 where ptag1 = 100 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  t1
--------+-------
    100 | 1000
(1 row)
> select ptag1, t1, t2 from only_tag.table1 where ptag1 = 100 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  t1  |  t2
--------+------+--------
    100 | 1000 | 10000
(1 row)
> select ptag1, t1, t2, t3 from only_tag.table1 where ptag1 = 100 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  t3
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
(1 row)
> select ptag1 from only_tag.table1 where t1 > 1000 group by ptag1 ORDER by ptag1;
  ptag1
---------
    200
    300
    400
    500
    600
    700
(6 rows)
> select ptag1, t1 from only_tag.table1 where t1 > 1000 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  t1
--------+-------
    200 | 2000
    300 | 3000
    400 | 4000
    500 | 5000
    600 | 6000
    700 | 7000
(6 rows)
> select ptag1, t1, t2 from only_tag.table1 where t1 > 1000 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  t1  |  t2
--------+------+--------
    200 | 2000 | 20000
    300 | 3000 | 30000
    400 | 4000 | 40000
    500 | 5000 | 50000
    600 | 6000 | 60000
    700 | 7000 | 70000
(6 rows)
> select ptag1, t1, t2, t3 from only_tag.table1 where t1 > 1000 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  t3
--------+------+-------+--------
    200 | 2000 | 20000 | 20000
    300 | 3000 | 30000 | 30000
    400 | 4000 | 40000 | 40000
    500 | 5000 | 50000 | 50000
    600 | 6000 | 60000 | 60000
    700 | 7000 | 70000 | 70000
(6 rows)
> select ptag1 from only_tag.table1 where ptag1 = 200 and t1 > 1000 group by ptag1 ORDER by ptag1;
  ptag1
---------
    200
(1 row)
> select ptag1, t1 from only_tag.table1 where ptag1 = 200 and t1 > 1000 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  t1
--------+-------
    200 | 2000
(1 row)
> select ptag1, t1, t2 from only_tag.table1 where ptag1 = 200 and t1 > 1000 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  t1  |  t2
--------+------+--------
    200 | 2000 | 20000
(1 row)
> select ptag1, t1, t2, t3 from only_tag.table1 where ptag1 = 200 and t1 > 1000 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  t3
--------+------+-------+--------
    200 | 2000 | 20000 | 20000
(1 row)
> select ptag1, sum(t1+t2) from only_tag.table1 group by ptag1 ORDER by ptag1;
  ptag1 |  sum
--------+--------
    100 | 11000
    200 | 22000
    300 | 33000
    400 | 44000
    500 | 55000
    600 | 66000
    700 | 77000
(7 rows)
> select ptag1, sum(t1+t2) from only_tag.table1 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  sum
--------+--------
    100 | 11000
    200 | 22000
    300 | 33000
    400 | 44000
    500 | 55000
    600 | 66000
    700 | 77000
(7 rows)
> select ptag1, sum(t1+t2) from only_tag.table1 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  sum
--------+--------
    100 | 11000
    200 | 22000
    300 | 33000
    400 | 44000
    500 | 55000
    600 | 66000
    700 | 77000
(7 rows)
> select ptag1, sum(t1+t2+t3) from only_tag.table1 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 |  sum
--------+---------
    100 |  21000
    200 |  42000
    300 |  63000
    400 |  84000
    500 | 105000
    600 | 126000
    700 | 147000
(7 rows)
> select sum(t1+t2) as s1 from only_tag.table1 group by ptag1 having sum(t1) > 3000 order by s1;
   s1
---------
  44000
  55000
  66000
  77000
(4 rows)
> select sum(t1+t2) as s1 from only_tag.table1 group by ptag1 having sum(t1) > 3000 order by s1;
   s1
---------
  44000
  55000
  66000
  77000
(4 rows)
> select sum(t1+t2) as s1 from only_tag.table1 group by ptag1, t1 having sum(t1) > 3000 order by s1;
   s1
---------
  44000
  55000
  66000
  77000
(4 rows)
> select sum(t1+t2) as s1 from only_tag.table1 group by ptag1, t1, t2 having sum(t1) > 3000 order by s1;
   s1
---------
  44000
  55000
  66000
  77000
(4 rows)
> select sum(t1+t2+t3) as s1 from only_tag.table1 group by ptag1, t1, t2, t3 having sum(t1) > 3000 order by s1;
    s1
----------
   84000
  105000
  126000
  147000
(4 rows)
> select ptag1, sum(t1+t2) as sm from only_tag.table1 where ptag1 = 200 and t1 > 1000 group by ptag1 order by sm;
  ptag1 |  sm
--------+--------
    200 | 22000
(1 row)
> select ptag1, sum(t1+t2) as sm from only_tag.table1 where ptag1 = 200 and t1 > 1000 group by ptag1, t1 order by sm;
  ptag1 |  sm
--------+--------
    200 | 22000
(1 row)
> select ptag1, sum(t1+t2) as sm from only_tag.table1 where ptag1 = 200 and t1 > 1000 group by ptag1, t1, t2 order by sm;
  ptag1 |  sm
--------+--------
    200 | 22000
(1 row)
> select ptag1, sum(t1+t2) as sm from only_tag.table1 where ptag1 = 200 and t1 > 1000 group by ptag1, t1, t2, t3 order by sm;
  ptag1 |  sm
--------+--------
    200 | 22000
(1 row)
> select ptag1, sum(t1+t2) as sm from only_tag.table1 where t1 > 1000 group by ptag1 order by sm limit 2 offset 1;
  ptag1 |  sm
--------+--------
    300 | 33000
    400 | 44000
(2 rows)
> select ptag1, sum(t1+t2) as sm from only_tag.table1 where t1 > 1000 group by ptag1, t1 order by sm limit 2 offset 1;
  ptag1 |  sm
--------+--------
    300 | 33000
    400 | 44000
(2 rows)
> select ptag1, sum(t1+t2) as sm from only_tag.table1 where t1 > 1000 group by ptag1, t1, t2 order by sm limit 2 offset 1;
  ptag1 |  sm
--------+--------
    300 | 33000
    400 | 44000
(2 rows)
> select ptag1, sum(t1+t2) as sm from only_tag.table1 where t1 > 1000 group by ptag1, t1, t2, t3 order by sm limit 2 offset 1;
  ptag1 |  sm
--------+--------
    300 | 33000
    400 | 44000
(2 rows)
> select distinct ptag1 from only_tag.table2 ORDER by ptag1;
  ptag1
---------
    100
    200
    300
    400
    500
    600
    700
(7 rows)
> select distinct ptag1, t1 from only_tag.table2 ORDER by ptag1;
  ptag1 |  t1
--------+-------
    100 | 1000
    200 | 2000
    300 | 3000
    400 | 4000
    500 | 5000
    600 | 6000
    700 | 7000
(7 rows)
> select distinct ptag1, t1, t2 from only_tag.table2 ORDER by ptag1;
  ptag1 |  t1  |  t2
--------+------+--------
    100 | 1000 | 10000
    200 | 2000 | 20000
    300 | 3000 | 30000
    400 | 4000 | 40000
    500 | 5000 | 50000
    600 | 6000 | 60000
    700 | 7000 | 70000
(7 rows)
> select distinct ptag1, t1, t2, t3 from only_tag.table2 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  t3
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
    200 | 2000 | 20000 | 20000
    300 | 3000 | 30000 | 30000
    400 | 4000 | 40000 | 40000
    500 | 5000 | 50000 | 50000
    600 | 6000 | 60000 | 60000
    700 | 7000 | 70000 | 70000
(7 rows)
> select ptag1 from only_tag.table2 group by ptag1 ORDER by ptag1;
  ptag1
---------
    100
    200
    300
    400
    500
    600
    700
(7 rows)
> select ptag1, t1 from only_tag.table2 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  t1
--------+-------
    100 | 1000
    200 | 2000
    300 | 3000
    400 | 4000
    500 | 5000
    600 | 6000
    700 | 7000
(7 rows)
> select ptag1, t1, t2 from only_tag.table2 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  t1  |  t2
--------+------+--------
    100 | 1000 | 10000
    200 | 2000 | 20000
    300 | 3000 | 30000
    400 | 4000 | 40000
    500 | 5000 | 50000
    600 | 6000 | 60000
    700 | 7000 | 70000
(7 rows)
> select ptag1, t1, t2, t3 from only_tag.table2 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  t3
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
    200 | 2000 | 20000 | 20000
    300 | 3000 | 30000 | 30000
    400 | 4000 | 40000 | 40000
    500 | 5000 | 50000 | 50000
    600 | 6000 | 60000 | 60000
    700 | 7000 | 70000 | 70000
(7 rows)
> select ptag1, sum(t1) from only_tag.table2 group by ptag1 ORDER by ptag1;
  ptag1 | sum
--------+-------
    100 | 2000
    200 | 2000
    300 | 3000
    400 | 4000
    500 | 5000
    600 | 6000
    700 | 7000
(7 rows)
> select ptag1, t1, sum(t2) from only_tag.table2 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  t1  |  sum
--------+------+--------
    100 | 1000 | 10000
    200 | 2000 | 20000
    300 | 3000 | 30000
    400 | 4000 | 40000
    500 | 5000 | 50000
    600 | 6000 | 60000
    700 | 7000 | 70000
(7 rows)
> select ptag1, t1, t2, sum(t3) from only_tag.table2 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  sum
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
    200 | 2000 | 20000 | 20000
    300 | 3000 | 30000 | 30000
    400 | 4000 | 40000 | 40000
    500 | 5000 | 50000 | 50000
    600 | 6000 | 60000 | 60000
    700 | 7000 | 70000 | 70000
(7 rows)
> select ptag1, sum(t1), sum(t2), sum(t3) from only_tag.table2 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 | sum  |  sum  |  sum
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
    200 | 2000 | 20000 | 20000
    300 | 3000 | 30000 | 30000
    400 | 4000 | 40000 | 40000
    500 | 5000 | 50000 | 50000
    600 | 6000 | 60000 | 60000
    700 | 7000 | 70000 | 70000
(7 rows)
> select ptag1 from only_tag.table2 where ptag1 = 100 group by ptag1 ORDER by ptag1;
  ptag1
---------
    100
(1 row)
> select ptag1, t1 from only_tag.table2 where ptag1 = 100 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  t1
--------+-------
    100 | 1000
(1 row)
> select ptag1, t1, t2 from only_tag.table2 where ptag1 = 100 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  t1  |  t2
--------+------+--------
    100 | 1000 | 10000
(1 row)
> select ptag1, t1, t2, t3 from only_tag.table2 where ptag1 = 100 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  t3
--------+------+-------+--------
    100 | 1000 | 10000 | 10000
(1 row)
> select ptag1 from only_tag.table2 where ptag1 = 200 and t1 > 1000 group by ptag1 ORDER by ptag1;
  ptag1
---------
    200
(1 row)
> select ptag1, t1 from only_tag.table2 where ptag1 = 200 and t1 > 1000 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  t1
--------+-------
    200 | 2000
(1 row)
> select ptag1, t1, t2 from only_tag.table2 where ptag1 = 200 and t1 > 1000 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  t1  |  t2
--------+------+--------
    200 | 2000 | 20000
(1 row)
> select ptag1, t1, t2, t3 from only_tag.table2 where ptag1 = 200 and t1 > 1000 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 |  t1  |  t2   |  t3
--------+------+-------+--------
    200 | 2000 | 20000 | 20000
(1 row)
> select ptag1, sum(t1+t2) from only_tag.table2 group by ptag1 ORDER by ptag1;
  ptag1 |  sum
--------+--------
    100 | 22000
    200 | 22000
    300 | 33000
    400 | 44000
    500 | 55000
    600 | 66000
    700 | 77000
(7 rows)
> select ptag1, sum(t1+t2) from only_tag.table2 group by ptag1, t1 ORDER by ptag1;
  ptag1 |  sum
--------+--------
    100 | 11000
    200 | 22000
    300 | 33000
    400 | 44000
    500 | 55000
    600 | 66000
    700 | 77000
(7 rows)
> select ptag1, sum(t1+t2) from only_tag.table2 group by ptag1, t1, t2 ORDER by ptag1;
  ptag1 |  sum
--------+--------
    100 | 11000
    200 | 22000
    300 | 33000
    400 | 44000
    500 | 55000
    600 | 66000
    700 | 77000
(7 rows)
> select ptag1, sum(t1+t2+t3) from only_tag.table2 group by ptag1, t1, t2, t3 ORDER by ptag1;
  ptag1 |  sum
--------+---------
    100 |  21000
    200 |  42000
    300 |  63000
    400 |  84000
    500 | 105000
    600 | 126000
    700 | 147000
(7 rows)
> select sum(t1+t2) as s1 from only_tag.table2 group by ptag1 having sum(t1) > 3000 order by s1;
   s1
---------
  44000
  55000
  66000
  77000
(4 rows)
> select sum(t1+t2) as s1 from only_tag.table2 group by ptag1 having sum(t1) > 3000 order by s1;
   s1
---------
  44000
  55000
  66000
  77000
(4 rows)
> select sum(t1+t2) as s1 from only_tag.table2 group by ptag1, t1 having sum(t1) > 3000 order by s1;
   s1
---------
  44000
  55000
  66000
  77000
(4 rows)
> select sum(t1+t2) as s1 from only_tag.table2 group by ptag1, t1, t2 having sum(t1) > 3000 order by s1;
   s1
---------
  44000
  55000
  66000
  77000
(4 rows)
> select sum(t1+t2+t3) as s1 from only_tag.table2 group by ptag1, t1, t2, t3 having sum(t1) > 3000 order by s1;
    s1
----------
   84000
  105000
  126000
  147000
(4 rows)
> select ptag1, sum(t1+t2) as sm from only_tag.table2 where ptag1 = 200 and t1 > 1000 group by ptag1 order by sm;
  ptag1 |  sm
--------+--------
    200 | 22000
(1 row)
> select ptag1, sum(t1+t2) as sm from only_tag.table2 where ptag1 = 200 and t1 > 1000 group by ptag1, t1 order by sm;
  ptag1 |  sm
--------+--------
    200 | 22000
(1 row)
> select ptag1, sum(t1+t2) as sm from only_tag.table2 where ptag1 = 200 and t1 > 1000 group by ptag1, t1, t2 order by sm;
  ptag1 |  sm
--------+--------
    200 | 22000
(1 row)
> select ptag1, sum(t1+t2) as sm from only_tag.table2 where ptag1 = 200 and t1 > 1000 group by ptag1, t1, t2, t3 order by sm;
  ptag1 |  sm
--------+--------
    200 | 22000
(1 row)
> select ptag1, sum(t1+t2) as sm from only_tag.table2 where t1 > 1000 group by ptag1 order by sm limit 2 offset 1;
  ptag1 |  sm
--------+--------
    300 | 33000
    400 | 44000
(2 rows)
> select ptag1, sum(t1+t2) as sm from only_tag.table2 where t1 > 1000 group by ptag1, t1 order by sm limit 2 offset 1;
  ptag1 |  sm
--------+--------
    300 | 33000
    400 | 44000
(2 rows)
> select ptag1, sum(t1+t2) as sm from only_tag.table2 where t1 > 1000 group by ptag1, t1, t2 order by sm limit 2 offset 1;
  ptag1 |  sm
--------+--------
    300 | 33000
    400 | 44000
(2 rows)
> select ptag1, sum(t1+t2) as sm from only_tag.table2 where t1 > 1000 group by ptag1, t1, t2, t3 order by sm limit 2 offset 1;
  ptag1 |  sm
--------+--------
    300 | 33000
    400 | 44000
(2 rows)
> explain select avg(t1), sum(t2), count(t3) from only_tag.table3 where t1+t2 > 3000 and t3 < 80000 group by ptag1;
           tree          |     field     |    description
-------------------------+---------------+---------------------
                         | distributed   | true
                         | vectorized    | false
  render                 |               |
   │                     | avg           | avg
   │                     | sum           | sum
   │                     | count         | count
   └── group             |               |
        │                | aggregate 0   | ptag1
        │                | aggregate 1   | avg(t1)
        │                | aggregate 2   | sum(t2)
        │                | aggregate 3   | count(t3)
        │                | group by      | ptag1
        └── filter       |               |
             │           | filter        | (t1 + t2) > 3000.0
             └── ts scan |               |
                         | ts-table      | table3
                         | only tag      | true
                         | access mode   | tableTableMeta
                         | tag filter[0] | t3 < 80000.0
(19 rows)
> select avg(t1), sum(t2), count(t3) from only_tag.table3 where t1+t2 > 3000 and t3 < 80000 group by ptag1 order by avg(t1);
  avg  |  sum  | count
-------+-------+--------
  1000 | 10000 |     1
  2000 | 20000 |     1
  3000 | 30000 |     1
  4000 | 40000 |     1
  5000 | 50000 |     1
  6000 | 60000 |     1
  7000 | 70000 |     1
(7 rows)
> use defaultdb;
SET
> drop database only_tag cascade;
DROP DATABASE
