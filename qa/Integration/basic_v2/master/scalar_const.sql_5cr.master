> set cluster setting sql.query_cache.enabled=true;
SET CLUSTER SETTING
> drop database if EXISTS test;
DROP DATABASE
> drop database if EXISTS test_ts;
DROP DATABASE
> create database test;
CREATE DATABASE
> use test;
SET
> create table test1(col1 smallint primary key, col2 int, col3 bigint, col4 float, col5 bool, col6 varchar);
CREATE TABLE
> insert into test1 values(1000,1000000,100000000000000000,100000000000000000.101,true, 'test_c1'), (2000,2000000,200000000000000000,200000000000000000.202,true, 'test_c2');
INSERT 2
> create ts database test_ts;
CREATE TS DATABASE
> use test_ts;
SET
> create table ts_table
(time timestamp not null, e1 smallint, e2 int, e3 bigint, e4 float, e5 bool, e6 varchar)
attributes (attr1 smallint not null, attr2 int not null, attr3 bigint, attr4 float, attr5 bool, attr6 varchar)
primary attributes (attr1, attr2);
CREATE TABLE
> create table ts_table2
(time timestamp not null, e1 smallint, e2 int, e3 bigint, e4 float, e5 bool, e6 varchar)
attributes (attr1 smallint not null, attr2 int not null, attr3 bigint, attr4 float, attr5 bool, attr6 varchar)
primary attributes (attr1, attr2);
CREATE TABLE
> insert into ts_table values('2023-05-31 10:00:00', 1000,1000000,100000000000000000,100000000000000000.101,true, 'test_ts1', 1000, 1000000, 1000000000, 100.11, false, 'test_attr_ts'), ('2023-05-31 11:00:00', 2000,2000000,200000000000000000,200000000000000000.202,true, 'test_ts1', 1000, 1000000, 1000000000, 100.11, false, 'test_attr_ts');
INSERT 2
> insert into ts_table2 values('2023-05-31 10:00:00', 1000,1000000,100000000000000000,100000000000000000.101,true, 'test_ts1', 1000, 1000000, 1000000000, 100.11, false, 'test_attr_ts'), ('2023-05-31 11:00:00', 2000,2000000,200000000000000000,200000000000000000.202,true, 'test_ts1', 1000, 1000000, 1000000000, 100.11, false, 'test_attr_ts');
INSERT 2
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from ts_table;
        tree        |    field    | description
--------------------+-------------+--------------
                    | distributed | true
                    | vectorized  | false
  synchronizer      |             |
   └── render       |             |
        │           | engine type | time series
        │           | extract     | 0.0
        └── ts scan |             |
                    | ts-table    | ts_table
                    | access mode | metaTable
(9 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table order by e1 desc limit 1 offset 1;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | 0.0
   └── limit                       |             |
        │                          | engine type | time series
        │                          | offset      | 1
        └── limit                  |             |
             │                     | engine type | time series
             │                     | count       | 2
             └── sort              |             |
                  │                | order       | -e1
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
(16 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table order by e1 desc limit 1 offset 1;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | 0.0
   └── limit                       |             |
        │                          | engine type | time series
        │                          | offset      | 1
        └── limit                  |             |
             │                     | engine type | time series
             │                     | count       | 2
             └── sort              |             |
                  │                | order       | -e1
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
(16 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table order by attr2 desc limit 1 offset 1;
                tree               |    field    |  description
-----------------------------------+-------------+-----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | 0.0
   └── limit                       |             |
        │                          | engine type | time series
        │                          | offset      | 1
        └── limit                  |             |
             │                     | engine type | time series
             │                     | count       | 2
             └── sort              |             |
                  │                | order       | -attr2
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | tableTableMeta
(16 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where e3 < 300000000000000000;
        tree        |    field    |       description
--------------------+-------------+--------------------------
                    | distributed | true
                    | vectorized  | false
  synchronizer      |             |
   └── render       |             |
        │           | engine type | time series
        │           | extract     | 0.0
        └── ts scan |             |
                    | ts-table    | ts_table
                    | access mode | metaTable
                    | filter      | e3 < 300000000000000000
(10 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where e3 < 300000000000000000;
        tree        |    field    |       description
--------------------+-------------+--------------------------
                    | distributed | true
                    | vectorized  | false
  synchronizer      |             |
   └── render       |             |
        │           | engine type | time series
        │           | extract     | 0.0
        └── ts scan |             |
                    | ts-table    | ts_table
                    | access mode | metaTable
                    | filter      | e3 < 300000000000000000
(10 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where attr3 < 300000000000000000;
        tree        |     field     |        description
--------------------+---------------+-----------------------------
                    | distributed   | true
                    | vectorized    | false
  synchronizer      |               |
   └── render       |               |
        │           | engine type   | time series
        │           | extract       | 0.0
        └── ts scan |               |
                    | ts-table      | ts_table
                    | access mode   | tableTableMeta
                    | tag filter[0] | attr3 < 300000000000000000
(10 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where attr2 < 2000000;
        tree        |     field     |   description
--------------------+---------------+------------------
                    | distributed   | true
                    | vectorized    | false
  synchronizer      |               |
   └── render       |               |
        │           | engine type   | time series
        │           | extract       | 0.0
        └── ts scan |               |
                    | ts-table      | ts_table
                    | access mode   | tableTableMeta
                    | tag filter[0] | attr2 < 2000000
(10 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table union select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table2;
           tree          |    field    | description
-------------------------+-------------+--------------
                         | distributed | true
                         | vectorized  | false
  union                  |             |
   ├── synchronizer      |             |
   │    └── render       |             |
   │         │           | engine type | time series
   │         │           | extract     | 0.0
   │         └── ts scan |             |
   │                     | ts-table    | ts_table2
   │                     | access mode | metaTable
   └── synchronizer      |             |
        └── render       |             |
             │           | engine type | time series
             │           | extract     | 0.0
             └── ts scan |             |
                         | ts-table    | ts_table
                         | access mode | metaTable
(17 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from (select e1,e2,e3 from test_ts.ts_table union (select e1,e2,e3 from test_ts.ts_table2 union select e1,e2,e3 from test_ts.ts_table)) as t where t.e1 < 2000 order by e2;
                  tree                  |    field    | description
----------------------------------------+-------------+--------------
                                        | distributed | true
                                        | vectorized  | false
  render                                |             |
   │                                    | extract     | "extract"
   └── sort                             |             |
        │                               | order       | +e2
        └── render                      |             |
             │                          | extract     | 0.0
             │                          | e2          | e2
             └── union                  |             |
                  ├── union             |             |
                  │    ├── synchronizer |             |
                  │    │    └── ts scan |             |
                  │    │                | ts-table    | ts_table
                  │    │                | access mode | metaTable
                  │    │                | filter      | e1 < 2000
                  │    └── synchronizer |             |
                  │         └── ts scan |             |
                  │                     | ts-table    | ts_table2
                  │                     | access mode | metaTable
                  │                     | filter      | e1 < 2000
                  └── synchronizer      |             |
                       └── ts scan      |             |
                                        | ts-table    | ts_table
                                        | access mode | metaTable
                                        | filter      | e1 < 2000
(26 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from (select e1,e2,e3 from test_ts.ts_table union (select e1,e2,e3 from test_ts.ts_table2 union select e1,e2,e3 from test_ts.ts_table)) as t where t.e1-1000 < 3000 order by e2 desc limit 1 offset 1;
                     tree                    |    field    | description
---------------------------------------------+-------------+--------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | 0.0
   └── limit                                 |             |
        │                                    | offset      | 1
        └── limit                            |             |
             │                               | count       | 2
             └── sort                        |             |
                  │                          | order       | -e2
                  └── union                  |             |
                       ├── union             |             |
                       │    ├── synchronizer |             |
                       │    │    └── ts scan |             |
                       │    │                | ts-table    | ts_table
                       │    │                | access mode | metaTable
                       │    │                | filter      | e1 < 4000
                       │    └── synchronizer |             |
                       │         └── ts scan |             |
                       │                     | ts-table    | ts_table2
                       │                     | access mode | metaTable
                       │                     | filter      | e1 < 4000
                       └── synchronizer      |             |
                            └── ts scan      |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e1 < 4000
(27 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2) order by e2;
                  tree                  |       field        | description
----------------------------------------+--------------------+--------------
                                        | distributed        | true
                                        | vectorized         | false
  render                                |                    |
   │                                    | extract            | 0.0
   └── render                           |                    |
        │                               | e1                 | e1
        │                               | e2                 | e2
        └── sort                        |                    |
             │                          | order              | +e2
             └── hash-join              |                    |
                  │                     | type               | inner
                  │                     | equality           | (e1) = (e1)
                  │                     | right cols are key |
                  ├── synchronizer      |                    |
                  │    └── ts scan      |                    |
                  │                     | ts-table           | ts_table
                  │                     | access mode        | metaTable
                  └── distinct          |                    |
                       │                | distinct on        | e1
                       └── synchronizer |                    |
                            └── ts scan |                    |
                                        | ts-table           | ts_table2
                                        | access mode        | metaTable
(23 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2 group by e1 having e1 < 3000) order by e2;
                  tree                  |       field        | description
----------------------------------------+--------------------+--------------
                                        | distributed        | true
                                        | vectorized         | false
  render                                |                    |
   │                                    | extract            | "extract"
   └── sort                             |                    |
        │                               | order              | +e2
        └── render                      |                    |
             │                          | extract            | 0.0
             │                          | e2                 | e2
             └── hash-join              |                    |
                  │                     | type               | semi
                  │                     | equality           | (e1) = (e1)
                  │                     | right cols are key |
                  ├── synchronizer      |                    |
                  │    └── ts scan      |                    |
                  │                     | ts-table           | ts_table
                  │                     | access mode        | metaTable
                  └── distinct          |                    |
                       │                | distinct on        | e1
                       └── synchronizer |                    |
                            └── ts scan |                    |
                                        | ts-table           | ts_table2
                                        | access mode        | metaTable
                                        | filter             | e1 < 3000
(24 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2 order by e3 desc limit 1 offset 1) order by e2;
                       tree                       |    field    | description
--------------------------------------------------+-------------+--------------
                                                  | distributed | true
                                                  | vectorized  | false
  render                                          |             |
   │                                              | extract     | "extract"
   └── sort                                       |             |
        │                                         | order       | +e2
        └── render                                |             |
             │                                    | extract     | 0.0
             │                                    | e2          | e2
             └── hash-join                        |             |
                  │                               | type        | semi
                  │                               | equality    | (e1) = (e1)
                  ├── synchronizer                |             |
                  │    └── ts scan                |             |
                  │                               | ts-table    | ts_table
                  │                               | access mode | metaTable
                  └── limit                       |             |
                       │                          | engine type | time series
                       │                          | offset      | 1
                       └── limit                  |             |
                            │                     | engine type | time series
                            │                     | count       | 2
                            └── sort              |             |
                                 │                | order       | -e3
                                 └── synchronizer |             |
                                      └── ts scan |             |
                                                  | ts-table    | ts_table2
                                                  | access mode | metaTable
(28 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2) group by e2 having e2 < 3000000 order by e2;
                       tree                       |       field        | description
--------------------------------------------------+--------------------+---------------
                                                  | distributed        | true
                                                  | vectorized         | false
  render                                          |                    |
   │                                              | extract            | "extract"
   └── sort                                       |                    |
        │                                         | order              | +e2
        └── render                                |                    |
             │                                    | extract            | 0.0
             │                                    | e2                 | e2
             └── distinct                         |                    |
                  │                               | distinct on        | e2
                  └── render                      |                    |
                       │                          | e2                 | e2
                       └── hash-join              |                    |
                            │                     | type               | inner
                            │                     | equality           | (e1) = (e1)
                            │                     | right cols are key |
                            ├── synchronizer      |                    |
                            │    └── ts scan      |                    |
                            │                     | ts-table           | ts_table
                            │                     | access mode        | metaTable
                            │                     | filter             | e2 < 3000000
                            └── distinct          |                    |
                                 │                | distinct on        | e1
                                 └── synchronizer |                    |
                                      └── ts scan |                    |
                                                  | ts-table           | ts_table2
                                                  | access mode        | metaTable
(28 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2) order by e3 desc limit 1 offset 1;
                       tree                       |       field        | description
--------------------------------------------------+--------------------+--------------
                                                  | distributed        | true
                                                  | vectorized         | false
  render                                          |                    |
   │                                              | extract            | 0.0
   └── limit                                      |                    |
        │                                         | offset             | 1
        └── limit                                 |                    |
             │                                    | count              | 2
             └── render                           |                    |
                  │                               | e1                 | e1
                  │                               | e3                 | e3
                  └── sort                        |                    |
                       │                          | order              | -e3
                       └── hash-join              |                    |
                            │                     | type               | inner
                            │                     | equality           | (e1) = (e1)
                            │                     | right cols are key |
                            ├── synchronizer      |                    |
                            │    └── ts scan      |                    |
                            │                     | ts-table           | ts_table
                            │                     | access mode        | metaTable
                            └── distinct          |                    |
                                 │                | distinct on        | e1
                                 └── synchronizer |                    |
                                      └── ts scan |                    |
                                                  | ts-table           | ts_table2
                                                  | access mode        | metaTable
(27 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2) order by e2;
                  tree                  |       field        | description
----------------------------------------+--------------------+--------------
                                        | distributed        | true
                                        | vectorized         | false
  render                                |                    |
   │                                    | extract            | 0.0
   └── render                           |                    |
        │                               | e1                 | e1
        │                               | e2                 | e2
        └── sort                        |                    |
             │                          | order              | +e2
             └── hash-join              |                    |
                  │                     | type               | inner
                  │                     | equality           | (e1) = (e1)
                  │                     | right cols are key |
                  ├── synchronizer      |                    |
                  │    └── ts scan      |                    |
                  │                     | ts-table           | ts_table
                  │                     | access mode        | metaTable
                  └── distinct          |                    |
                       │                | distinct on        | e1
                       └── synchronizer |                    |
                            └── ts scan |                    |
                                        | ts-table           | ts_table2
                                        | access mode        | metaTable
(23 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) = ( select e4 from test_ts.ts_table2 limit 1 ) from test_ts.ts_table;
                tree               |    field     |                   description
-----------------------------------+--------------+---------------------------------------------------
                                   | distributed  | true
                                   | vectorized   | false
  root                             |              |
   ├── synchronizer                |              |
   │    └── render                 |              |
   │         │                     | engine type  | time series
   │         │                     | ?column?     | 0.0 = (SELECT e4 FROM test_ts.ts_table2 LIMIT 1)
   │         └── ts scan           |              |
   │                               | ts-table     | ts_table
   │                               | access mode  | metaTable
   └── subquery                    |              |
        │                          | id           | @S1
        │                          | original sql | (SELECT e4 FROM test_ts.ts_table2 LIMIT 1)
        │                          | exec mode    | one row
        └── limit                  |              |
             │                     | engine type  | time series
             │                     | count        | 1
             └── synchronizer      |              |
                  └── limit        |              |
                       │           | engine type  | time series
                       │           | count        | 1
                       └── ts scan |              |
                                   | ts-table     | ts_table2
                                   | access mode  | metaTable
(24 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) in ( select e4 from test_ts.ts_table2 where e2 > 1000000 group by e4) from test_ts.ts_table;
                tree               |    field     |                                 description
-----------------------------------+--------------+------------------------------------------------------------------------------
                                   | distributed  | true
                                   | vectorized   | false
  root                             |              |
   ├── synchronizer                |              |
   │    └── render                 |              |
   │         │                     | engine type  | time series
   │         │                     | ?column?     | 0.0 = ANY (SELECT e4 FROM test_ts.ts_table2 WHERE e2 > 1000000 GROUP BY e4)
   │         └── ts scan           |              |
   │                               | ts-table     | ts_table
   │                               | access mode  | metaTable
   └── subquery                    |              |
        │                          | id           | @S1
        │                          | original sql | (SELECT e4 FROM test_ts.ts_table2 WHERE e2 > 1000000 GROUP BY e4)
        │                          | exec mode    | all rows normalized
        └── distinct               |              |
             │                     | distinct on  | e4
             └── render            |              |
                  │                | engine type  | time series
                  │                | e4           | e4
                  └── synchronizer |              |
                       └── ts scan |              |
                                   | ts-table     | ts_table2
                                   | access mode  | metaTable
                                   | filter       | e2 > 1000000
(24 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) in ( select e4 from test_ts.ts_table2 order by e3 desc limit 10 offset 1) from test_ts.ts_table;
                     tree                    |    field     |                                   description
---------------------------------------------+--------------+----------------------------------------------------------------------------------
                                             | distributed  | true
                                             | vectorized   | false
  root                                       |              |
   ├── synchronizer                          |              |
   │    └── render                           |              |
   │         │                               | engine type  | time series
   │         │                               | ?column?     | 0.0 = ANY (SELECT e4 FROM test_ts.ts_table2 ORDER BY e3 DESC LIMIT 10 OFFSET 1)
   │         └── ts scan                     |              |
   │                                         | ts-table     | ts_table
   │                                         | access mode  | metaTable
   └── subquery                              |              |
        │                                    | id           | @S1
        │                                    | original sql | (SELECT e4 FROM test_ts.ts_table2 ORDER BY e3 DESC LIMIT 10 OFFSET 1)
        │                                    | exec mode    | all rows normalized
        └── render                           |              |
             │                               | e4           | e4
             └── limit                       |              |
                  │                          | engine type  | time series
                  │                          | offset       | 1
                  └── limit                  |              |
                       │                     | engine type  | time series
                       │                     | count        | 11
                       └── sort              |              |
                            │                | order        | -e3
                            └── synchronizer |              |
                                 └── ts scan |              |
                                             | ts-table     | ts_table2
                                             | access mode  | metaTable
(28 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) in ( select e4 from test_ts.ts_table2 ) from test_ts.ts_table order by e3 desc limit 10 offset 1;
                  tree                  |    field     |                 description
----------------------------------------+--------------+-----------------------------------------------
                                        | distributed  | true
                                        | vectorized   | false
  root                                  |              |
   ├── render                           |              |
   │    │                               | ?column?     | 0.0 = ANY (SELECT e4 FROM test_ts.ts_table2)
   │    └── limit                       |              |
   │         │                          | engine type  | time series
   │         │                          | offset       | 1
   │         └── limit                  |              |
   │              │                     | engine type  | time series
   │              │                     | count        | 11
   │              └── sort              |              |
   │                   │                | order        | -e3
   │                   └── synchronizer |              |
   │                        └── ts scan |              |
   │                                    | ts-table     | ts_table
   │                                    | access mode  | metaTable
   └── subquery                         |              |
        │                               | id           | @S1
        │                               | original sql | (SELECT e4 FROM test_ts.ts_table2)
        │                               | exec mode    | all rows normalized
        └── synchronizer                |              |
             └── ts scan                |              |
                                        | ts-table     | ts_table2
                                        | access mode  | metaTable
(25 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 join test_ts.ts_table2 as t2 on t1.e1=t2.e1 order by t1.e2;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 0.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
(20 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 join test_ts.ts_table2 as t2 on t1.e1=t2.e1 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e2;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 0.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  │                | filter      | e2 < 3000000
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
                                   | filter      | e4 > 1000.101
(22 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                     tree                    |    field    | description
---------------------------------------------+-------------+---------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | "extract"
   └── sort                                  |             |
        │                                    | order       | +e2
        └── render                           |             |
             │                               | extract     | 0.0
             │                               | e2          | e2
             └── distinct                    |             |
                  │                          | distinct on | e2
                  └── render                 |             |
                       │                     | e2          | e2
                       └── hash-join         |             |
                            │                | type        | inner
                            │                | equality    | (e1) = (e1)
                            ├── synchronizer |             |
                            │    └── ts scan |             |
                            │                | ts-table    | ts_table2
                            │                | access mode | metaTable
                            └── synchronizer |             |
                                 └── ts scan |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e2 > 1000000
(25 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 left join test_ts.ts_table2 as t2 on t1.e1=t2.e1 order by t1.e2;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 0.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | left outer
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
(20 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 left join test_ts.ts_table2 as t2 on t1.e1=t2.e1 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e2;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 0.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  │                | filter      | e2 < 3000000
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
                                   | filter      | e4 > 1000.101
(22 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 left join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                     tree                    |    field    | description
---------------------------------------------+-------------+---------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | "extract"
   └── sort                                  |             |
        │                                    | order       | +e2
        └── render                           |             |
             │                               | extract     | 0.0
             │                               | e2          | e2
             └── distinct                    |             |
                  │                          | distinct on | e2
                  └── render                 |             |
                       │                     | e2          | e2
                       └── hash-join         |             |
                            │                | type        | right outer
                            │                | equality    | (e1) = (e1)
                            ├── synchronizer |             |
                            │    └── ts scan |             |
                            │                | ts-table    | ts_table2
                            │                | access mode | metaTable
                            └── synchronizer |             |
                                 └── ts scan |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e2 > 1000000
(25 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 right join test_ts.ts_table2 as t2 on t1.e1=t2.e1 order by t1.e2;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 0.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | left outer
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table2
                  │                | access mode | metaTable
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
(20 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 right join test_ts.ts_table2 as t2 on t1.e1=t2.e1 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e2;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 0.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table2
                  │                | access mode | metaTable
                  │                | filter      | e4 > 1000.101
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
                                   | filter      | e2 < 3000000
(22 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 right join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                     tree                    |    field    | description
---------------------------------------------+-------------+---------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | "extract"
   └── sort                                  |             |
        │                                    | order       | +e2
        └── render                           |             |
             │                               | extract     | 0.0
             │                               | e2          | e2
             └── distinct                    |             |
                  │                          | distinct on | e2
                  └── render                 |             |
                       │                     | e2          | e2
                       └── hash-join         |             |
                            │                | type        | inner
                            │                | equality    | (e1) = (e1)
                            ├── synchronizer |             |
                            │    └── ts scan |             |
                            │                | ts-table    | ts_table2
                            │                | access mode | metaTable
                            └── synchronizer |             |
                                 └── ts scan |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e2 > 1000000
(25 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 full join test_ts.ts_table2 as t2 on t1.e1=t2.e1 order by t1.e2;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 0.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | full outer
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
(20 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 full join test_ts.ts_table2 as t2 on t1.e1=t2.e1 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e2;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 0.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table2
                  │                | access mode | metaTable
                  │                | filter      | e4 > 1000.101
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
                                   | filter      | e2 < 3000000
(22 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1 full join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                     tree                    |    field    | description
---------------------------------------------+-------------+---------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | "extract"
   └── sort                                  |             |
        │                                    | order       | +e2
        └── render                           |             |
             │                               | extract     | 0.0
             │                               | e2          | e2
             └── distinct                    |             |
                  │                          | distinct on | e2
                  └── render                 |             |
                       │                     | e2          | e2
                       └── hash-join         |             |
                            │                | type        | right outer
                            │                | equality    | (e1) = (e1)
                            ├── synchronizer |             |
                            │    └── ts scan |             |
                            │                | ts-table    | ts_table2
                            │                | access mode | metaTable
                            └── synchronizer |             |
                                 └── ts scan |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e2 > 1000000
(25 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table, test_ts.ts_table2;
           tree          |    field    | description
-------------------------+-------------+--------------
                         | distributed | true
                         | vectorized  | false
  render                 |             |
   │                     | extract     | 0.0
   └── cross-join        |             |
        │                | type        | cross
        ├── synchronizer |             |
        │    └── ts scan |             |
        │                | ts-table    | ts_table
        │                | access mode | metaTable
        └── synchronizer |             |
             └── ts scan |             |
                         | ts-table    | ts_table2
                         | access mode | metaTable
(14 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1, test_ts.ts_table2 as t2 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e1;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e1
        └── render                 |             |
             │                     | extract     | 0.0
             │                     | e1          | e1
             └── cross-join        |             |
                  │                | type        | cross
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  │                | filter      | e2 < 3000000
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
                                   | filter      | e4 > 1000.101
(21 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1, test_ts.ts_table2 as t2 group by t1.e1, t2.e1 having t1.e1 > 1000 or t2.e1 < 3000 order by t1.e1;
                  tree                  |    field    |        description
----------------------------------------+-------------+-----------------------------
                                        | distributed | true
                                        | vectorized  | false
  render                                |             |
   │                                    | extract     | "extract"
   └── sort                             |             |
        │                               | order       | +e1
        └── render                      |             |
             │                          | extract     | 0.0
             │                          | e1          | e1
             └── distinct               |             |
                  │                     | distinct on | e1, e1
                  └── cross-join        |             |
                       │                | type        | inner
                       │                | pred        | (e1 > 1000) OR (e1 < 3000)
                       ├── synchronizer |             |
                       │    └── ts scan |             |
                       │                | ts-table    | ts_table
                       │                | access mode | metaTable
                       └── synchronizer |             |
                            └── ts scan |             |
                                        | ts-table    | ts_table2
                                        | access mode | metaTable
(22 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1, test_ts.ts_table2 as t2 order by t1.e1 desc limit 10 offset 1;
                  tree                  |    field    | description
----------------------------------------+-------------+--------------
                                        | distributed | true
                                        | vectorized  | false
  render                                |             |
   │                                    | extract     | 0.0
   └── limit                            |             |
        │                               | offset      | 1
        └── limit                       |             |
             │                          | count       | 11
             └── sort                   |             |
                  │                     | order       | -e1
                  └── cross-join        |             |
                       │                | type        | cross
                       ├── synchronizer |             |
                       │    └── ts scan |             |
                       │                | ts-table    | ts_table
                       │                | access mode | metaTable
                       └── synchronizer |             |
                            └── ts scan |             |
                                        | ts-table    | ts_table2
                                        | access mode | metaTable
(20 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test_ts.ts_table as t1, test_ts.ts_table2 as t2 order by t1.e1 desc limit 10 offset 1;
                  tree                  |    field    | description
----------------------------------------+-------------+--------------
                                        | distributed | true
                                        | vectorized  | false
  render                                |             |
   │                                    | extract     | 0.0
   └── limit                            |             |
        │                               | offset      | 1
        └── limit                       |             |
             │                          | count       | 11
             └── sort                   |             |
                  │                     | order       | -e1
                  └── cross-join        |             |
                       │                | type        | cross
                       ├── synchronizer |             |
                       │    └── ts scan |             |
                       │                | ts-table    | ts_table
                       │                | access mode | metaTable
                       └── synchronizer |             |
                            └── ts scan |             |
                                        | ts-table    | ts_table2
                                        | access mode | metaTable
(20 rows)
> explain select extract('year', localtimestamp()) from ts_table;
        tree        |    field    | description
--------------------+-------------+--------------
                    | distributed | true
                    | vectorized  | false
  synchronizer      |             |
   └── render       |             |
        │           | engine type | time series
        │           | extract     | 2024.0
        └── ts scan |             |
                    | ts-table    | ts_table
                    | access mode | metaTable
(9 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table group by e1 having e1 < 3000;
           tree          |    field    | description
-------------------------+-------------+--------------
                         | distributed | true
                         | vectorized  | false
  render                 |             |
   │                     | extract     | 2024.0
   └── distinct          |             |
        │                | distinct on | e1
        └── synchronizer |             |
             └── ts scan |             |
                         | ts-table    | ts_table
                         | access mode | metaTable
                         | filter      | e1 < 3000
(11 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table order by e1 desc limit 1 offset 1;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | 2024.0
   └── limit                       |             |
        │                          | engine type | time series
        │                          | offset      | 1
        └── limit                  |             |
             │                     | engine type | time series
             │                     | count       | 2
             └── sort              |             |
                  │                | order       | -e1
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
(16 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table order by e1 desc limit 1 offset 1;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | 2024.0
   └── limit                       |             |
        │                          | engine type | time series
        │                          | offset      | 1
        └── limit                  |             |
             │                     | engine type | time series
             │                     | count       | 2
             └── sort              |             |
                  │                | order       | -e1
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
(16 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table order by attr2 desc limit 1 offset 1;
                tree               |    field    |  description
-----------------------------------+-------------+-----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | 2024.0
   └── limit                       |             |
        │                          | engine type | time series
        │                          | offset      | 1
        └── limit                  |             |
             │                     | engine type | time series
             │                     | count       | 2
             └── sort              |             |
                  │                | order       | -attr2
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | tableTableMeta
(16 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e3 < 300000000000000000;
        tree        |    field    |       description
--------------------+-------------+--------------------------
                    | distributed | true
                    | vectorized  | false
  synchronizer      |             |
   └── render       |             |
        │           | engine type | time series
        │           | extract     | 2024.0
        └── ts scan |             |
                    | ts-table    | ts_table
                    | access mode | metaTable
                    | filter      | e3 < 300000000000000000
(10 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e3 < 300000000000000000;
        tree        |    field    |       description
--------------------+-------------+--------------------------
                    | distributed | true
                    | vectorized  | false
  synchronizer      |             |
   └── render       |             |
        │           | engine type | time series
        │           | extract     | 2024.0
        └── ts scan |             |
                    | ts-table    | ts_table
                    | access mode | metaTable
                    | filter      | e3 < 300000000000000000
(10 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where attr3 < 300000000000000000;
        tree        |     field     |        description
--------------------+---------------+-----------------------------
                    | distributed   | true
                    | vectorized    | false
  synchronizer      |               |
   └── render       |               |
        │           | engine type   | time series
        │           | extract       | 2024.0
        └── ts scan |               |
                    | ts-table      | ts_table
                    | access mode   | tableTableMeta
                    | tag filter[0] | attr3 < 300000000000000000
(10 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where attr2 < 2000000;
        tree        |     field     |   description
--------------------+---------------+------------------
                    | distributed   | true
                    | vectorized    | false
  synchronizer      |               |
   └── render       |               |
        │           | engine type   | time series
        │           | extract       | 2024.0
        └── ts scan |               |
                    | ts-table      | ts_table
                    | access mode   | tableTableMeta
                    | tag filter[0] | attr2 < 2000000
(10 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table union select extract('year', localtimestamp()) from test_ts.ts_table2;
           tree          |    field    | description
-------------------------+-------------+--------------
                         | distributed | true
                         | vectorized  | false
  union                  |             |
   ├── synchronizer      |             |
   │    └── render       |             |
   │         │           | engine type | time series
   │         │           | extract     | 2024.0
   │         └── ts scan |             |
   │                     | ts-table    | ts_table2
   │                     | access mode | metaTable
   └── synchronizer      |             |
        └── render       |             |
             │           | engine type | time series
             │           | extract     | 2024.0
             └── ts scan |             |
                         | ts-table    | ts_table
                         | access mode | metaTable
(17 rows)
> explain select extract('year', localtimestamp()) from (select e1,e2,e3 from test_ts.ts_table union (select e1,e2,e3 from test_ts.ts_table2 union select e1,e2,e3 from test_ts.ts_table)) as t where t.e1 < 2000 order by e2;
                  tree                  |    field    | description
----------------------------------------+-------------+--------------
                                        | distributed | true
                                        | vectorized  | false
  render                                |             |
   │                                    | extract     | "extract"
   └── sort                             |             |
        │                               | order       | +e2
        └── render                      |             |
             │                          | extract     | 2024.0
             │                          | e2          | e2
             └── union                  |             |
                  ├── union             |             |
                  │    ├── synchronizer |             |
                  │    │    └── ts scan |             |
                  │    │                | ts-table    | ts_table
                  │    │                | access mode | metaTable
                  │    │                | filter      | e1 < 2000
                  │    └── synchronizer |             |
                  │         └── ts scan |             |
                  │                     | ts-table    | ts_table2
                  │                     | access mode | metaTable
                  │                     | filter      | e1 < 2000
                  └── synchronizer      |             |
                       └── ts scan      |             |
                                        | ts-table    | ts_table
                                        | access mode | metaTable
                                        | filter      | e1 < 2000
(26 rows)
> explain select extract('year', localtimestamp()) from (select e1,e2,e3 from test_ts.ts_table union (select e1,e2,e3 from test_ts.ts_table2 union select e1,e2,e3 from test_ts.ts_table)) as t where t.e1-1000 < 3000 order by e2 desc limit 1 offset 1;
                     tree                    |    field    | description
---------------------------------------------+-------------+--------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | 2024.0
   └── limit                                 |             |
        │                                    | offset      | 1
        └── limit                            |             |
             │                               | count       | 2
             └── sort                        |             |
                  │                          | order       | -e2
                  └── union                  |             |
                       ├── union             |             |
                       │    ├── synchronizer |             |
                       │    │    └── ts scan |             |
                       │    │                | ts-table    | ts_table
                       │    │                | access mode | metaTable
                       │    │                | filter      | e1 < 4000
                       │    └── synchronizer |             |
                       │         └── ts scan |             |
                       │                     | ts-table    | ts_table2
                       │                     | access mode | metaTable
                       │                     | filter      | e1 < 4000
                       └── synchronizer      |             |
                            └── ts scan      |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e1 < 4000
(27 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2) order by e2;
                  tree                  |       field        | description
----------------------------------------+--------------------+--------------
                                        | distributed        | true
                                        | vectorized         | false
  render                                |                    |
   │                                    | extract            | 2024.0
   └── render                           |                    |
        │                               | e1                 | e1
        │                               | e2                 | e2
        └── sort                        |                    |
             │                          | order              | +e2
             └── hash-join              |                    |
                  │                     | type               | inner
                  │                     | equality           | (e1) = (e1)
                  │                     | right cols are key |
                  ├── synchronizer      |                    |
                  │    └── ts scan      |                    |
                  │                     | ts-table           | ts_table
                  │                     | access mode        | metaTable
                  └── distinct          |                    |
                       │                | distinct on        | e1
                       └── synchronizer |                    |
                            └── ts scan |                    |
                                        | ts-table           | ts_table2
                                        | access mode        | metaTable
(23 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2 group by e1 having e1 < 3000) order by e2;
                  tree                  |       field        | description
----------------------------------------+--------------------+--------------
                                        | distributed        | true
                                        | vectorized         | false
  render                                |                    |
   │                                    | extract            | "extract"
   └── sort                             |                    |
        │                               | order              | +e2
        └── render                      |                    |
             │                          | extract            | 2024.0
             │                          | e2                 | e2
             └── hash-join              |                    |
                  │                     | type               | semi
                  │                     | equality           | (e1) = (e1)
                  │                     | right cols are key |
                  ├── synchronizer      |                    |
                  │    └── ts scan      |                    |
                  │                     | ts-table           | ts_table
                  │                     | access mode        | metaTable
                  └── distinct          |                    |
                       │                | distinct on        | e1
                       └── synchronizer |                    |
                            └── ts scan |                    |
                                        | ts-table           | ts_table2
                                        | access mode        | metaTable
                                        | filter             | e1 < 3000
(24 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2 order by e3 desc limit 1 offset 1) order by e2;
                       tree                       |    field    | description
--------------------------------------------------+-------------+--------------
                                                  | distributed | true
                                                  | vectorized  | false
  render                                          |             |
   │                                              | extract     | "extract"
   └── sort                                       |             |
        │                                         | order       | +e2
        └── render                                |             |
             │                                    | extract     | 2024.0
             │                                    | e2          | e2
             └── hash-join                        |             |
                  │                               | type        | semi
                  │                               | equality    | (e1) = (e1)
                  ├── synchronizer                |             |
                  │    └── ts scan                |             |
                  │                               | ts-table    | ts_table
                  │                               | access mode | metaTable
                  └── limit                       |             |
                       │                          | engine type | time series
                       │                          | offset      | 1
                       └── limit                  |             |
                            │                     | engine type | time series
                            │                     | count       | 2
                            └── sort              |             |
                                 │                | order       | -e3
                                 └── synchronizer |             |
                                      └── ts scan |             |
                                                  | ts-table    | ts_table2
                                                  | access mode | metaTable
(28 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2) group by e2 having e2 < 3000000 order by e2;
                       tree                       |       field        | description
--------------------------------------------------+--------------------+---------------
                                                  | distributed        | true
                                                  | vectorized         | false
  render                                          |                    |
   │                                              | extract            | "extract"
   └── sort                                       |                    |
        │                                         | order              | +e2
        └── render                                |                    |
             │                                    | extract            | 2024.0
             │                                    | e2                 | e2
             └── distinct                         |                    |
                  │                               | distinct on        | e2
                  └── render                      |                    |
                       │                          | e2                 | e2
                       └── hash-join              |                    |
                            │                     | type               | inner
                            │                     | equality           | (e1) = (e1)
                            │                     | right cols are key |
                            ├── synchronizer      |                    |
                            │    └── ts scan      |                    |
                            │                     | ts-table           | ts_table
                            │                     | access mode        | metaTable
                            │                     | filter             | e2 < 3000000
                            └── distinct          |                    |
                                 │                | distinct on        | e1
                                 └── synchronizer |                    |
                                      └── ts scan |                    |
                                                  | ts-table           | ts_table2
                                                  | access mode        | metaTable
(28 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2) order by e3 desc limit 1 offset 1;
                       tree                       |       field        | description
--------------------------------------------------+--------------------+--------------
                                                  | distributed        | true
                                                  | vectorized         | false
  render                                          |                    |
   │                                              | extract            | 2024.0
   └── limit                                      |                    |
        │                                         | offset             | 1
        └── limit                                 |                    |
             │                                    | count              | 2
             └── render                           |                    |
                  │                               | e1                 | e1
                  │                               | e3                 | e3
                  └── sort                        |                    |
                       │                          | order              | -e3
                       └── hash-join              |                    |
                            │                     | type               | inner
                            │                     | equality           | (e1) = (e1)
                            │                     | right cols are key |
                            ├── synchronizer      |                    |
                            │    └── ts scan      |                    |
                            │                     | ts-table           | ts_table
                            │                     | access mode        | metaTable
                            └── distinct          |                    |
                                 │                | distinct on        | e1
                                 └── synchronizer |                    |
                                      └── ts scan |                    |
                                                  | ts-table           | ts_table2
                                                  | access mode        | metaTable
(27 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2) order by e2;
                  tree                  |       field        | description
----------------------------------------+--------------------+--------------
                                        | distributed        | true
                                        | vectorized         | false
  render                                |                    |
   │                                    | extract            | 2024.0
   └── render                           |                    |
        │                               | e1                 | e1
        │                               | e2                 | e2
        └── sort                        |                    |
             │                          | order              | +e2
             └── hash-join              |                    |
                  │                     | type               | inner
                  │                     | equality           | (e1) = (e1)
                  │                     | right cols are key |
                  ├── synchronizer      |                    |
                  │    └── ts scan      |                    |
                  │                     | ts-table           | ts_table
                  │                     | access mode        | metaTable
                  └── distinct          |                    |
                       │                | distinct on        | e1
                       └── synchronizer |                    |
                            └── ts scan |                    |
                                        | ts-table           | ts_table2
                                        | access mode        | metaTable
(23 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2 where e3 = (select e3 from test_ts.ts_table where e6='test_ts1' limit 1)) group by e2 having e2 < 3000000 order by e2;
                            tree                            |       field        |                           description
------------------------------------------------------------+--------------------+------------------------------------------------------------------
                                                            | distributed        | true
                                                            | vectorized         | false
  root                                                      |                    |
   ├── render                                               |                    |
   │    │                                                   | extract            | "extract"
   │    └── sort                                            |                    |
   │         │                                              | order              | +e2
   │         └── render                                     |                    |
   │              │                                         | extract            | 2024.0
   │              │                                         | e2                 | e2
   │              └── distinct                              |                    |
   │                   │                                    | distinct on        | e2
   │                   └── render                           |                    |
   │                        │                               | e2                 | e2
   │                        └── hash-join                   |                    |
   │                             │                          | type               | inner
   │                             │                          | equality           | (e1) = (e1)
   │                             │                          | right cols are key |
   │                             ├── synchronizer           |                    |
   │                             │    └── ts scan           |                    |
   │                             │                          | ts-table           | ts_table
   │                             │                          | access mode        | metaTable
   │                             │                          | filter             | e2 < 3000000
   │                             └── distinct               |                    |
   │                                  │                     | distinct on        | e1
   │                                  └── render            |                    |
   │                                       │                | engine type        | time series
   │                                       │                | e1                 | e1
   │                                       └── synchronizer |                    |
   │                                            └── ts scan |                    |
   │                                                        | ts-table           | ts_table2
   │                                                        | access mode        | metaTable
   │                                                        | filter             | e3 = @S1
   └── subquery                                             |                    |
        │                                                   | id                 | @S1
        │                                                   | original sql       | (SELECT e3 FROM test_ts.ts_table WHERE e6 = 'test_ts1' LIMIT 1)
        │                                                   | exec mode          | one row
        └── render                                          |                    |
             │                                              | engine type        | time series
             │                                              | e3                 | e3
             └── limit                                      |                    |
                  │                                         | engine type        | time series
                  │                                         | count              | 1
                  └── synchronizer                          |                    |
                       └── limit                            |                    |
                            │                               | engine type        | time series
                            │                               | count              | 1
                            └── ts scan                     |                    |
                                                            | ts-table           | ts_table
                                                            | access mode        | metaTable
                                                            | filter             | e6 = 'test_ts1'
(51 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2 where e3 = (select e3 from test_ts.ts_table where e6='test_ts1' limit 1)) order by e3 desc limit 1 offset 1;
                            tree                            |       field        |                           description
------------------------------------------------------------+--------------------+------------------------------------------------------------------
                                                            | distributed        | true
                                                            | vectorized         | false
  root                                                      |                    |
   ├── render                                               |                    |
   │    │                                                   | extract            | 2024.0
   │    └── limit                                           |                    |
   │         │                                              | offset             | 1
   │         └── limit                                      |                    |
   │              │                                         | count              | 2
   │              └── render                                |                    |
   │                   │                                    | e1                 | e1
   │                   │                                    | e3                 | e3
   │                   └── sort                             |                    |
   │                        │                               | order              | -e3
   │                        └── hash-join                   |                    |
   │                             │                          | type               | inner
   │                             │                          | equality           | (e1) = (e1)
   │                             │                          | right cols are key |
   │                             ├── synchronizer           |                    |
   │                             │    └── ts scan           |                    |
   │                             │                          | ts-table           | ts_table
   │                             │                          | access mode        | metaTable
   │                             └── distinct               |                    |
   │                                  │                     | distinct on        | e1
   │                                  └── render            |                    |
   │                                       │                | engine type        | time series
   │                                       │                | e1                 | e1
   │                                       └── synchronizer |                    |
   │                                            └── ts scan |                    |
   │                                                        | ts-table           | ts_table2
   │                                                        | access mode        | metaTable
   │                                                        | filter             | e3 = @S1
   └── subquery                                             |                    |
        │                                                   | id                 | @S1
        │                                                   | original sql       | (SELECT e3 FROM test_ts.ts_table WHERE e6 = 'test_ts1' LIMIT 1)
        │                                                   | exec mode          | one row
        └── render                                          |                    |
             │                                              | engine type        | time series
             │                                              | e3                 | e3
             └── limit                                      |                    |
                  │                                         | engine type        | time series
                  │                                         | count              | 1
                  └── synchronizer                          |                    |
                       └── limit                            |                    |
                            │                               | engine type        | time series
                            │                               | count              | 1
                            └── ts scan                     |                    |
                                                            | ts-table           | ts_table
                                                            | access mode        | metaTable
                                                            | filter             | e6 = 'test_ts1'
(50 rows)
> explain select extract('year', localtimestamp()) = ( select e4 from test_ts.ts_table2 limit 1 ) from test_ts.ts_table;
                tree               |    field     |                     description
-----------------------------------+--------------+------------------------------------------------------
                                   | distributed  | true
                                   | vectorized   | false
  root                             |              |
   ├── synchronizer                |              |
   │    └── render                 |              |
   │         │                     | engine type  | time series
   │         │                     | ?column?     | 2024.0 = (SELECT e4 FROM test_ts.ts_table2 LIMIT 1)
   │         └── ts scan           |              |
   │                               | ts-table     | ts_table
   │                               | access mode  | metaTable
   └── subquery                    |              |
        │                          | id           | @S1
        │                          | original sql | (SELECT e4 FROM test_ts.ts_table2 LIMIT 1)
        │                          | exec mode    | one row
        └── limit                  |              |
             │                     | engine type  | time series
             │                     | count        | 1
             └── synchronizer      |              |
                  └── limit        |              |
                       │           | engine type  | time series
                       │           | count        | 1
                       └── ts scan |              |
                                   | ts-table     | ts_table2
                                   | access mode  | metaTable
(24 rows)
> explain select extract('year', localtimestamp()) in ( select e4 from test_ts.ts_table2 where e2 > 1000000 group by e4) from test_ts.ts_table;
                tree               |    field     |                                  description
-----------------------------------+--------------+---------------------------------------------------------------------------------
                                   | distributed  | true
                                   | vectorized   | false
  root                             |              |
   ├── synchronizer                |              |
   │    └── render                 |              |
   │         │                     | engine type  | time series
   │         │                     | ?column?     | 2024.0 = ANY (SELECT e4 FROM test_ts.ts_table2 WHERE e2 > 1000000 GROUP BY e4)
   │         └── ts scan           |              |
   │                               | ts-table     | ts_table
   │                               | access mode  | metaTable
   └── subquery                    |              |
        │                          | id           | @S1
        │                          | original sql | (SELECT e4 FROM test_ts.ts_table2 WHERE e2 > 1000000 GROUP BY e4)
        │                          | exec mode    | all rows normalized
        └── distinct               |              |
             │                     | distinct on  | e4
             └── render            |              |
                  │                | engine type  | time series
                  │                | e4           | e4
                  └── synchronizer |              |
                       └── ts scan |              |
                                   | ts-table     | ts_table2
                                   | access mode  | metaTable
                                   | filter       | e2 > 1000000
(24 rows)
> explain select extract('year', localtimestamp()) in ( select e4 from test_ts.ts_table2 order by e3 desc limit 10 offset 1) from test_ts.ts_table;
                     tree                    |    field     |                                    description
---------------------------------------------+--------------+-------------------------------------------------------------------------------------
                                             | distributed  | true
                                             | vectorized   | false
  root                                       |              |
   ├── synchronizer                          |              |
   │    └── render                           |              |
   │         │                               | engine type  | time series
   │         │                               | ?column?     | 2024.0 = ANY (SELECT e4 FROM test_ts.ts_table2 ORDER BY e3 DESC LIMIT 10 OFFSET 1)
   │         └── ts scan                     |              |
   │                                         | ts-table     | ts_table
   │                                         | access mode  | metaTable
   └── subquery                              |              |
        │                                    | id           | @S1
        │                                    | original sql | (SELECT e4 FROM test_ts.ts_table2 ORDER BY e3 DESC LIMIT 10 OFFSET 1)
        │                                    | exec mode    | all rows normalized
        └── render                           |              |
             │                               | e4           | e4
             └── limit                       |              |
                  │                          | engine type  | time series
                  │                          | offset       | 1
                  └── limit                  |              |
                       │                     | engine type  | time series
                       │                     | count        | 11
                       └── sort              |              |
                            │                | order        | -e3
                            └── synchronizer |              |
                                 └── ts scan |              |
                                             | ts-table     | ts_table2
                                             | access mode  | metaTable
(28 rows)
> explain select extract('year', localtimestamp()) in ( select e4 from test_ts.ts_table2 ) from test_ts.ts_table order by e3 desc limit 10 offset 1;
                  tree                  |    field     |                   description
----------------------------------------+--------------+--------------------------------------------------
                                        | distributed  | true
                                        | vectorized   | false
  root                                  |              |
   ├── render                           |              |
   │    │                               | ?column?     | 2024.0 = ANY (SELECT e4 FROM test_ts.ts_table2)
   │    └── limit                       |              |
   │         │                          | engine type  | time series
   │         │                          | offset       | 1
   │         └── limit                  |              |
   │              │                     | engine type  | time series
   │              │                     | count        | 11
   │              └── sort              |              |
   │                   │                | order        | -e3
   │                   └── synchronizer |              |
   │                        └── ts scan |              |
   │                                    | ts-table     | ts_table
   │                                    | access mode  | metaTable
   └── subquery                         |              |
        │                               | id           | @S1
        │                               | original sql | (SELECT e4 FROM test_ts.ts_table2)
        │                               | exec mode    | all rows normalized
        └── synchronizer                |              |
             └── ts scan                |              |
                                        | ts-table     | ts_table2
                                        | access mode  | metaTable
(25 rows)
> explain select extract('year', localtimestamp()) in ( select e4 from test_ts.ts_table2 ), case e2 when 1000000 then 10 when 2000000 then 20 end from test_ts.ts_table order by e3 desc limit 1 offset 1;
                  tree                  |    field     |                      description
----------------------------------------+--------------+--------------------------------------------------------
                                        | distributed  | true
                                        | vectorized   | false
  root                                  |              |
   ├── render                           |              |
   │    │                               | ?column?     | 2024.0 = ANY (SELECT e4 FROM test_ts.ts_table2)
   │    │                               | case         | CASE e2 WHEN 1000000 THEN 10 WHEN 2000000 THEN 20 END
   │    └── limit                       |              |
   │         │                          | engine type  | time series
   │         │                          | offset       | 1
   │         └── limit                  |              |
   │              │                     | engine type  | time series
   │              │                     | count        | 2
   │              └── sort              |              |
   │                   │                | order        | -e3
   │                   └── synchronizer |              |
   │                        └── ts scan |              |
   │                                    | ts-table     | ts_table
   │                                    | access mode  | metaTable
   └── subquery                         |              |
        │                               | id           | @S1
        │                               | original sql | (SELECT e4 FROM test_ts.ts_table2)
        │                               | exec mode    | all rows normalized
        └── synchronizer                |              |
             └── ts scan                |              |
                                        | ts-table     | ts_table2
                                        | access mode  | metaTable
(26 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 join test_ts.ts_table2 as t2 on t1.e1=t2.e1 order by t1.e2;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 2024.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
(20 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 join test_ts.ts_table2 as t2 on t1.e1=t2.e1 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e2;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 2024.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  │                | filter      | e2 < 3000000
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
                                   | filter      | e4 > 1000.101
(22 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                     tree                    |    field    | description
---------------------------------------------+-------------+---------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | "extract"
   └── sort                                  |             |
        │                                    | order       | +e2
        └── render                           |             |
             │                               | extract     | 2024.0
             │                               | e2          | e2
             └── distinct                    |             |
                  │                          | distinct on | e2
                  └── render                 |             |
                       │                     | e2          | e2
                       └── hash-join         |             |
                            │                | type        | inner
                            │                | equality    | (e1) = (e1)
                            ├── synchronizer |             |
                            │    └── ts scan |             |
                            │                | ts-table    | ts_table2
                            │                | access mode | metaTable
                            └── synchronizer |             |
                                 └── ts scan |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e2 > 1000000
(25 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 left join test_ts.ts_table2 as t2 on t1.e1=t2.e1 order by t1.e2;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 2024.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | left outer
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
(20 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 left join test_ts.ts_table2 as t2 on t1.e1=t2.e1 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e2;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 2024.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  │                | filter      | e2 < 3000000
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
                                   | filter      | e4 > 1000.101
(22 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 left join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                     tree                    |    field    | description
---------------------------------------------+-------------+---------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | "extract"
   └── sort                                  |             |
        │                                    | order       | +e2
        └── render                           |             |
             │                               | extract     | 2024.0
             │                               | e2          | e2
             └── distinct                    |             |
                  │                          | distinct on | e2
                  └── render                 |             |
                       │                     | e2          | e2
                       └── hash-join         |             |
                            │                | type        | right outer
                            │                | equality    | (e1) = (e1)
                            ├── synchronizer |             |
                            │    └── ts scan |             |
                            │                | ts-table    | ts_table2
                            │                | access mode | metaTable
                            └── synchronizer |             |
                                 └── ts scan |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e2 > 1000000
(25 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 right join test_ts.ts_table2 as t2 on t1.e1=t2.e1 order by t1.e2;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 2024.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | left outer
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table2
                  │                | access mode | metaTable
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
(20 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 right join test_ts.ts_table2 as t2 on t1.e1=t2.e1 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e2;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 2024.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table2
                  │                | access mode | metaTable
                  │                | filter      | e4 > 1000.101
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
                                   | filter      | e2 < 3000000
(22 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 right join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                     tree                    |    field    | description
---------------------------------------------+-------------+---------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | "extract"
   └── sort                                  |             |
        │                                    | order       | +e2
        └── render                           |             |
             │                               | extract     | 2024.0
             │                               | e2          | e2
             └── distinct                    |             |
                  │                          | distinct on | e2
                  └── render                 |             |
                       │                     | e2          | e2
                       └── hash-join         |             |
                            │                | type        | inner
                            │                | equality    | (e1) = (e1)
                            ├── synchronizer |             |
                            │    └── ts scan |             |
                            │                | ts-table    | ts_table2
                            │                | access mode | metaTable
                            └── synchronizer |             |
                                 └── ts scan |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e2 > 1000000
(25 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 full join test_ts.ts_table2 as t2 on t1.e1=t2.e1 order by t1.e2;
                tree               |    field    | description
-----------------------------------+-------------+--------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 2024.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | full outer
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
(20 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 full join test_ts.ts_table2 as t2 on t1.e1=t2.e1 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e2;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e2
        └── render                 |             |
             │                     | extract     | 2024.0
             │                     | e2          | e2
             └── hash-join         |             |
                  │                | type        | inner
                  │                | equality    | (e1) = (e1)
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table2
                  │                | access mode | metaTable
                  │                | filter      | e4 > 1000.101
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table
                                   | access mode | metaTable
                                   | filter      | e2 < 3000000
(22 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1 full join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                     tree                    |    field    | description
---------------------------------------------+-------------+---------------
                                             | distributed | true
                                             | vectorized  | false
  render                                     |             |
   │                                         | extract     | "extract"
   └── sort                                  |             |
        │                                    | order       | +e2
        └── render                           |             |
             │                               | extract     | 2024.0
             │                               | e2          | e2
             └── distinct                    |             |
                  │                          | distinct on | e2
                  └── render                 |             |
                       │                     | e2          | e2
                       └── hash-join         |             |
                            │                | type        | right outer
                            │                | equality    | (e1) = (e1)
                            ├── synchronizer |             |
                            │    └── ts scan |             |
                            │                | ts-table    | ts_table2
                            │                | access mode | metaTable
                            └── synchronizer |             |
                                 └── ts scan |             |
                                             | ts-table    | ts_table
                                             | access mode | metaTable
                                             | filter      | e2 > 1000000
(25 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table, test_ts.ts_table2;
           tree          |    field    | description
-------------------------+-------------+--------------
                         | distributed | true
                         | vectorized  | false
  render                 |             |
   │                     | extract     | 2024.0
   └── cross-join        |             |
        │                | type        | cross
        ├── synchronizer |             |
        │    └── ts scan |             |
        │                | ts-table    | ts_table
        │                | access mode | metaTable
        └── synchronizer |             |
             └── ts scan |             |
                         | ts-table    | ts_table2
                         | access mode | metaTable
(14 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1, test_ts.ts_table2 as t2 where t1.e2 < 3000000 and t2.e4 > 1000.101 order by t1.e1;
                tree               |    field    |  description
-----------------------------------+-------------+----------------
                                   | distributed | true
                                   | vectorized  | false
  render                           |             |
   │                               | extract     | "extract"
   └── sort                        |             |
        │                          | order       | +e1
        └── render                 |             |
             │                     | extract     | 2024.0
             │                     | e1          | e1
             └── cross-join        |             |
                  │                | type        | cross
                  ├── synchronizer |             |
                  │    └── ts scan |             |
                  │                | ts-table    | ts_table
                  │                | access mode | metaTable
                  │                | filter      | e2 < 3000000
                  └── synchronizer |             |
                       └── ts scan |             |
                                   | ts-table    | ts_table2
                                   | access mode | metaTable
                                   | filter      | e4 > 1000.101
(21 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1, test_ts.ts_table2 as t2 group by t1.e1, t2.e1 having t1.e1 > 1000 or t2.e1 < 3000 order by t1.e1;
                  tree                  |    field    |        description
----------------------------------------+-------------+-----------------------------
                                        | distributed | true
                                        | vectorized  | false
  render                                |             |
   │                                    | extract     | "extract"
   └── sort                             |             |
        │                               | order       | +e1
        └── render                      |             |
             │                          | extract     | 2024.0
             │                          | e1          | e1
             └── distinct               |             |
                  │                     | distinct on | e1, e1
                  └── cross-join        |             |
                       │                | type        | inner
                       │                | pred        | (e1 > 1000) OR (e1 < 3000)
                       ├── synchronizer |             |
                       │    └── ts scan |             |
                       │                | ts-table    | ts_table
                       │                | access mode | metaTable
                       └── synchronizer |             |
                            └── ts scan |             |
                                        | ts-table    | ts_table2
                                        | access mode | metaTable
(22 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1, test_ts.ts_table2 as t2 order by t1.e1 desc limit 10 offset 1;
                  tree                  |    field    | description
----------------------------------------+-------------+--------------
                                        | distributed | true
                                        | vectorized  | false
  render                                |             |
   │                                    | extract     | 2024.0
   └── limit                            |             |
        │                               | offset      | 1
        └── limit                       |             |
             │                          | count       | 11
             └── sort                   |             |
                  │                     | order       | -e1
                  └── cross-join        |             |
                       │                | type        | cross
                       ├── synchronizer |             |
                       │    └── ts scan |             |
                       │                | ts-table    | ts_table
                       │                | access mode | metaTable
                       └── synchronizer |             |
                            └── ts scan |             |
                                        | ts-table    | ts_table2
                                        | access mode | metaTable
(20 rows)
> explain select extract('year', localtimestamp()) from test_ts.ts_table as t1, test_ts.ts_table2 as t2 order by t1.e1 desc limit 10 offset 1;
                  tree                  |    field    | description
----------------------------------------+-------------+--------------
                                        | distributed | true
                                        | vectorized  | false
  render                                |             |
   │                                    | extract     | 2024.0
   └── limit                            |             |
        │                               | offset      | 1
        └── limit                       |             |
             │                          | count       | 11
             └── sort                   |             |
                  │                     | order       | -e1
                  └── cross-join        |             |
                       │                | type        | cross
                       ├── synchronizer |             |
                       │    └── ts scan |             |
                       │                | ts-table    | ts_table
                       │                | access mode | metaTable
                       └── synchronizer |             |
                            └── ts scan |             |
                                        | ts-table    | ts_table2
                                        | access mode | metaTable
(20 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from ts_table;
        tree        |                     field                      |                     description
--------------------+------------------------------------------------+------------------------------------------------------
                    | distributed                                    | true
                    | vectorized                                     | false
  group             |                                                |
   │                | engine type                                    | time series
   │                | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │                | scalar                                         |
   │                | addSynchronizer                                | true
   └── render       |                                                |
        │           | engine type                                    | time series
        │           | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
        └── ts scan |                                                |
                    | ts-table                                       | ts_table
                    | access mode                                    | metaTable
(13 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table where e3 < 300000000000000000;
        tree        |                     field                      |                     description
--------------------+------------------------------------------------+------------------------------------------------------
                    | distributed                                    | true
                    | vectorized                                     | false
  group             |                                                |
   │                | engine type                                    | time series
   │                | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │                | scalar                                         |
   │                | addSynchronizer                                | true
   └── render       |                                                |
        │           | engine type                                    | time series
        │           | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
        └── ts scan |                                                |
                    | ts-table                                       | ts_table
                    | access mode                                    | metaTable
                    | filter                                         | e3 < 300000000000000000
(14 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table where e3 < 300000000000000000;
        tree        |                     field                      |                     description
--------------------+------------------------------------------------+------------------------------------------------------
                    | distributed                                    | true
                    | vectorized                                     | false
  group             |                                                |
   │                | engine type                                    | time series
   │                | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │                | scalar                                         |
   │                | addSynchronizer                                | true
   └── render       |                                                |
        │           | engine type                                    | time series
        │           | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
        └── ts scan |                                                |
                    | ts-table                                       | ts_table
                    | access mode                                    | metaTable
                    | filter                                         | e3 < 300000000000000000
(14 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table where attr3 < 300000000000000000;
        tree        |                     field                      |                     description
--------------------+------------------------------------------------+------------------------------------------------------
                    | distributed                                    | true
                    | vectorized                                     | false
  group             |                                                |
   │                | engine type                                    | time series
   │                | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │                | scalar                                         |
   │                | addSynchronizer                                | true
   └── render       |                                                |
        │           | engine type                                    | time series
        │           | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
        └── ts scan |                                                |
                    | ts-table                                       | ts_table
                    | access mode                                    | tableTableMeta
                    | tag filter[0]                                  | attr3 < 300000000000000000
(14 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table where attr2 < 2000000;
        tree        |                     field                      |                     description
--------------------+------------------------------------------------+------------------------------------------------------
                    | distributed                                    | true
                    | vectorized                                     | false
  group             |                                                |
   │                | engine type                                    | time series
   │                | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │                | scalar                                         |
   │                | addSynchronizer                                | true
   └── render       |                                                |
        │           | engine type                                    | time series
        │           | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
        └── ts scan |                                                |
                    | ts-table                                       | ts_table
                    | access mode                                    | tableTableMeta
                    | tag filter[0]                                  | attr2 < 2000000
(14 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table union select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table2;
           tree          |                     field                      |                     description
-------------------------+------------------------------------------------+------------------------------------------------------
                         | distributed                                    | true
                         | vectorized                                     | false
  union                  |                                                |
   ├── group             |                                                |
   │    │                | engine type                                    | time series
   │    │                | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │    │                | scalar                                         |
   │    │                | addSynchronizer                                | true
   │    └── render       |                                                |
   │         │           | engine type                                    | time series
   │         │           | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
   │         └── ts scan |                                                |
   │                     | ts-table                                       | ts_table2
   │                     | access mode                                    | metaTable
   └── group             |                                                |
        │                | engine type                                    | time series
        │                | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
        │                | scalar                                         |
        │                | addSynchronizer                                | true
        └── render       |                                                |
             │           | engine type                                    | time series
             │           | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
             └── ts scan |                                                |
                         | ts-table                                       | ts_table
                         | access mode                                    | metaTable
(25 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2) group by e2 having e2 < 3000000 order by e2;
                       tree                       |                     field                      |                     description
--------------------------------------------------+------------------------------------------------+------------------------------------------------------
                                                  | distributed                                    | true
                                                  | vectorized                                     | false
  render                                          |                                                |
   │                                              | max                                            | max
   └── sort                                       |                                                |
        │                                         | order                                          | +e2
        └── group                                 |                                                |
             │                                    | aggregate 0                                    | e2
             │                                    | aggregate 1                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
             │                                    | group by                                       | e2
             └── render                           |                                                |
                  │                               | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
                  │                               | e2                                             | e2
                  └── render                      |                                                |
                       │                          | e1                                             | e1
                       │                          | e2                                             | e2
                       └── hash-join              |                                                |
                            │                     | type                                           | inner
                            │                     | equality                                       | (e1) = (e1)
                            │                     | right cols are key                             |
                            ├── synchronizer      |                                                |
                            │    └── ts scan      |                                                |
                            │                     | ts-table                                       | ts_table
                            │                     | access mode                                    | metaTable
                            │                     | filter                                         | e2 < 3000000
                            └── distinct          |                                                |
                                 │                | distinct on                                    | e1
                                 └── synchronizer |                                                |
                                      └── ts scan |                                                |
                                                  | ts-table                                       | ts_table2
                                                  | access mode                                    | metaTable
(31 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table where e1 in (select e1 from test_ts.ts_table2 where e3 = (select e3 from test_ts.ts_table where e6='test_ts1' limit 1)) group by e2 having e2 < 3000000 order by e2;
                            tree                            |                     field                      |                           description
------------------------------------------------------------+------------------------------------------------+------------------------------------------------------------------
                                                            | distributed                                    | true
                                                            | vectorized                                     | false
  root                                                      |                                                |
   ├── render                                               |                                                |
   │    │                                                   | max                                            | max
   │    └── sort                                            |                                                |
   │         │                                              | order                                          | +e2
   │         └── group                                      |                                                |
   │              │                                         | aggregate 0                                    | e2
   │              │                                         | aggregate 1                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │              │                                         | group by                                       | e2
   │              └── render                                |                                                |
   │                   │                                    | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
   │                   │                                    | e2                                             | e2
   │                   └── render                           |                                                |
   │                        │                               | e1                                             | e1
   │                        │                               | e2                                             | e2
   │                        └── hash-join                   |                                                |
   │                             │                          | type                                           | inner
   │                             │                          | equality                                       | (e1) = (e1)
   │                             │                          | right cols are key                             |
   │                             ├── synchronizer           |                                                |
   │                             │    └── ts scan           |                                                |
   │                             │                          | ts-table                                       | ts_table
   │                             │                          | access mode                                    | metaTable
   │                             │                          | filter                                         | e2 < 3000000
   │                             └── distinct               |                                                |
   │                                  │                     | distinct on                                    | e1
   │                                  └── render            |                                                |
   │                                       │                | engine type                                    | time series
   │                                       │                | e1                                             | e1
   │                                       └── synchronizer |                                                |
   │                                            └── ts scan |                                                |
   │                                                        | ts-table                                       | ts_table2
   │                                                        | access mode                                    | metaTable
   │                                                        | filter                                         | e3 = @S1
   └── subquery                                             |                                                |
        │                                                   | id                                             | @S1
        │                                                   | original sql                                   | (SELECT e3 FROM test_ts.ts_table WHERE e6 = 'test_ts1' LIMIT 1)
        │                                                   | exec mode                                      | one row
        └── render                                          |                                                |
             │                                              | engine type                                    | time series
             │                                              | e3                                             | e3
             └── limit                                      |                                                |
                  │                                         | engine type                                    | time series
                  │                                         | count                                          | 1
                  └── synchronizer                          |                                                |
                       └── limit                            |                                                |
                            │                               | engine type                                    | time series
                            │                               | count                                          | 1
                            └── ts scan                     |                                                |
                                                            | ts-table                                       | ts_table
                                                            | access mode                                    | metaTable
                                                            | filter                                         | e6 = 'test_ts1'
(54 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) = ( select e4 from test_ts.ts_table2 limit 1 ) from test_ts.ts_table;
                tree               |                     field                      |                     description
-----------------------------------+------------------------------------------------+------------------------------------------------------
                                   | distributed                                    | true
                                   | vectorized                                     | false
  root                             |                                                |
   ├── render                      |                                                |
   │    │                          | engine type                                    | time series
   │    │                          | ?column?                                       | max = (SELECT e4 FROM test_ts.ts_table2 LIMIT 1)
   │    └── group                  |                                                |
   │         │                     | engine type                                    | time series
   │         │                     | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │         │                     | scalar                                         |
   │         │                     | addSynchronizer                                | true
   │         └── render            |                                                |
   │              │                | engine type                                    | time series
   │              │                | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
   │              └── ts scan      |                                                |
   │                               | ts-table                                       | ts_table
   │                               | access mode                                    | metaTable
   └── subquery                    |                                                |
        │                          | id                                             | @S1
        │                          | original sql                                   | (SELECT e4 FROM test_ts.ts_table2 LIMIT 1)
        │                          | exec mode                                      | one row
        └── limit                  |                                                |
             │                     | engine type                                    | time series
             │                     | count                                          | 1
             └── synchronizer      |                                                |
                  └── limit        |                                                |
                       │           | engine type                                    | time series
                       │           | count                                          | 1
                       └── ts scan |                                                |
                                   | ts-table                                       | ts_table2
                                   | access mode                                    | metaTable
(31 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) in ( select e4 from test_ts.ts_table2 order by e3 desc limit 10 offset 1) from test_ts.ts_table;
                     tree                    |                     field                      |                                   description
---------------------------------------------+------------------------------------------------+----------------------------------------------------------------------------------
                                             | distributed                                    | true
                                             | vectorized                                     | false
  root                                       |                                                |
   ├── render                                |                                                |
   │    │                                    | engine type                                    | time series
   │    │                                    | ?column?                                       | max = ANY (SELECT e4 FROM test_ts.ts_table2 ORDER BY e3 DESC LIMIT 10 OFFSET 1)
   │    └── group                            |                                                |
   │         │                               | engine type                                    | time series
   │         │                               | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │         │                               | scalar                                         |
   │         │                               | addSynchronizer                                | true
   │         └── render                      |                                                |
   │              │                          | engine type                                    | time series
   │              │                          | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
   │              └── ts scan                |                                                |
   │                                         | ts-table                                       | ts_table
   │                                         | access mode                                    | metaTable
   └── subquery                              |                                                |
        │                                    | id                                             | @S1
        │                                    | original sql                                   | (SELECT e4 FROM test_ts.ts_table2 ORDER BY e3 DESC LIMIT 10 OFFSET 1)
        │                                    | exec mode                                      | all rows normalized
        └── render                           |                                                |
             │                               | e4                                             | e4
             └── limit                       |                                                |
                  │                          | engine type                                    | time series
                  │                          | offset                                         | 1
                  └── limit                  |                                                |
                       │                     | engine type                                    | time series
                       │                     | count                                          | 11
                       └── sort              |                                                |
                            │                | order                                          | -e3
                            └── synchronizer |                                                |
                                 └── ts scan |                                                |
                                             | ts-table                                       | ts_table2
                                             | access mode                                    | metaTable
(35 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table as t1 join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                  tree                  |                     field                      |                     description
----------------------------------------+------------------------------------------------+------------------------------------------------------
                                        | distributed                                    | true
                                        | vectorized                                     | false
  render                                |                                                |
   │                                    | max                                            | max
   └── sort                             |                                                |
        │                               | order                                          | +e2
        └── group                       |                                                |
             │                          | aggregate 0                                    | e2
             │                          | aggregate 1                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
             │                          | group by                                       | e2
             └── render                 |                                                |
                  │                     | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
                  │                     | e2                                             | e2
                  └── hash-join         |                                                |
                       │                | type                                           | inner
                       │                | equality                                       | (e1) = (e1)
                       ├── synchronizer |                                                |
                       │    └── ts scan |                                                |
                       │                | ts-table                                       | ts_table2
                       │                | access mode                                    | metaTable
                       └── synchronizer |                                                |
                            └── ts scan |                                                |
                                        | ts-table                                       | ts_table
                                        | access mode                                    | metaTable
                                        | filter                                         | e2 > 1000000
(25 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table as t1 left join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                  tree                  |                     field                      |                     description
----------------------------------------+------------------------------------------------+------------------------------------------------------
                                        | distributed                                    | true
                                        | vectorized                                     | false
  render                                |                                                |
   │                                    | max                                            | max
   └── sort                             |                                                |
        │                               | order                                          | +e2
        └── group                       |                                                |
             │                          | aggregate 0                                    | e2
             │                          | aggregate 1                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
             │                          | group by                                       | e2
             └── render                 |                                                |
                  │                     | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
                  │                     | e2                                             | e2
                  └── hash-join         |                                                |
                       │                | type                                           | right outer
                       │                | equality                                       | (e1) = (e1)
                       ├── synchronizer |                                                |
                       │    └── ts scan |                                                |
                       │                | ts-table                                       | ts_table2
                       │                | access mode                                    | metaTable
                       └── synchronizer |                                                |
                            └── ts scan |                                                |
                                        | ts-table                                       | ts_table
                                        | access mode                                    | metaTable
                                        | filter                                         | e2 > 1000000
(25 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table as t1 right join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                  tree                  |                     field                      |                     description
----------------------------------------+------------------------------------------------+------------------------------------------------------
                                        | distributed                                    | true
                                        | vectorized                                     | false
  render                                |                                                |
   │                                    | max                                            | max
   └── sort                             |                                                |
        │                               | order                                          | +e2
        └── group                       |                                                |
             │                          | aggregate 0                                    | e2
             │                          | aggregate 1                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
             │                          | group by                                       | e2
             └── render                 |                                                |
                  │                     | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
                  │                     | e2                                             | e2
                  └── hash-join         |                                                |
                       │                | type                                           | inner
                       │                | equality                                       | (e1) = (e1)
                       ├── synchronizer |                                                |
                       │    └── ts scan |                                                |
                       │                | ts-table                                       | ts_table2
                       │                | access mode                                    | metaTable
                       └── synchronizer |                                                |
                            └── ts scan |                                                |
                                        | ts-table                                       | ts_table
                                        | access mode                                    | metaTable
                                        | filter                                         | e2 > 1000000
(25 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table as t1 full join test_ts.ts_table2 as t2 on t1.e1=t2.e1 group by t1.e2 having t1.e2 > 1000000 order by t1.e2;
                  tree                  |                     field                      |                     description
----------------------------------------+------------------------------------------------+------------------------------------------------------
                                        | distributed                                    | true
                                        | vectorized                                     | false
  render                                |                                                |
   │                                    | max                                            | max
   └── sort                             |                                                |
        │                               | order                                          | +e2
        └── group                       |                                                |
             │                          | aggregate 0                                    | e2
             │                          | aggregate 1                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
             │                          | group by                                       | e2
             └── render                 |                                                |
                  │                     | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
                  │                     | e2                                             | e2
                  └── hash-join         |                                                |
                       │                | type                                           | right outer
                       │                | equality                                       | (e1) = (e1)
                       ├── synchronizer |                                                |
                       │    └── ts scan |                                                |
                       │                | ts-table                                       | ts_table2
                       │                | access mode                                    | metaTable
                       └── synchronizer |                                                |
                            └── ts scan |                                                |
                                        | ts-table                                       | ts_table
                                        | access mode                                    | metaTable
                                        | filter                                         | e2 > 1000000
(25 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table, test_ts.ts_table2;
             tree             |                     field                      |                     description
------------------------------+------------------------------------------------+------------------------------------------------------
                              | distributed                                    | true
                              | vectorized                                     | false
  group                       |                                                |
   │                          | aggregate 0                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
   │                          | scalar                                         |
   └── render                 |                                                |
        │                     | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
        └── cross-join        |                                                |
             │                | type                                           | cross
             ├── synchronizer |                                                |
             │    └── ts scan |                                                |
             │                | ts-table                                       | ts_table
             │                | access mode                                    | metaTable
             └── synchronizer |                                                |
                  └── ts scan |                                                |
                              | ts-table                                       | ts_table2
                              | access mode                                    | metaTable
(17 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test_ts.ts_table as t1, test_ts.ts_table2 as t2 group by t1.e1, t2.e1 having t1.e1 > 1000 or t2.e1 < 3000 order by t1.e1;
                     tree                    |                     field                      |                     description
---------------------------------------------+------------------------------------------------+------------------------------------------------------
                                             | distributed                                    | true
                                             | vectorized                                     | false
  render                                     |                                                |
   │                                         | max                                            | max
   └── sort                                  |                                                |
        │                                    | order                                          | +e1
        └── render                           |                                                |
             │                               | e1                                             | e1
             │                               | max                                            | max
             └── group                       |                                                |
                  │                          | aggregate 0                                    | e1
                  │                          | aggregate 1                                    | e1
                  │                          | aggregate 2                                    | max(extract('second', '2024-01-01 00:00:00+00:00'))
                  │                          | group by                                       | e1, e1
                  └── render                 |                                                |
                       │                     | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
                       │                     | e1                                             | e1
                       │                     | e1                                             | e1
                       └── cross-join        |                                                |
                            │                | type                                           | inner
                            │                | pred                                           | (e1 > 1000) OR (e1 < 3000)
                            ├── synchronizer |                                                |
                            │    └── ts scan |                                                |
                            │                | ts-table                                       | ts_table
                            │                | access mode                                    | metaTable
                            └── synchronizer |                                                |
                                 └── ts scan |                                                |
                                             | ts-table                                       | ts_table2
                                             | access mode                                    | metaTable
(29 rows)
> explain select extract('second', '2024-01-01 00:00:00'::timestamp) from test.test1 as a join test_ts.ts_table as b on a.col1=b.e1 where a.col1=1000 group by e1 order by e1;
             tree             |       field       |  description
------------------------------+-------------------+----------------
                              | distributed       | true
                              | vectorized        | false
  render                      |                   |
   │                          | extract           | 0.0
   └── limit                  |                   |
        │                     | count             | 1
        └── merge-join        |                   |
             │                | type              | inner
             │                | equality          | (col1) = (e1)
             │                | left cols are key |
             │                | mergeJoinOrder    | +"(col1=e1)"
             ├── scan         |                   |
             │                | table             | test1@primary
             │                | spans             | /1000-/1000/#
             └── synchronizer |                   |
                  └── ts scan |                   |
                              | ts-table          | ts_table
                              | access mode       | metaTable
                              | filter            | e1 = 1000
(19 rows)
> explain select extract('year', localtimestamp()) from test.test1 as a join test_ts.ts_table as b on a.col1=b.e1 where a.col1=1000 group by e1 order by e1;
             tree             |       field       |  description
------------------------------+-------------------+----------------
                              | distributed       | true
                              | vectorized        | false
  render                      |                   |
   │                          | extract           | 2024.0
   └── limit                  |                   |
        │                     | count             | 1
        └── merge-join        |                   |
             │                | type              | inner
             │                | equality          | (col1) = (e1)
             │                | left cols are key |
             │                | mergeJoinOrder    | +"(col1=e1)"
             ├── scan         |                   |
             │                | table             | test1@primary
             │                | spans             | /1000-/1000/#
             └── synchronizer |                   |
                  └── ts scan |                   |
                              | ts-table          | ts_table
                              | access mode       | metaTable
                              | filter            | e1 = 1000
(19 rows)
> explain select max(extract('second', '2024-01-01 00:00:00'::timestamp)) from test.test1 as a join test_ts.ts_table as b on a.col1=b.e1 where a.col1=1000 group by e1 order by e1;
                tree               |                     field                      |                   description
-----------------------------------+------------------------------------------------+---------------------------------------------------
                                   | distributed                                    | true
                                   | vectorized                                     | false
  render                           |                                                |
   │                               | max                                            | "extract('second', '2024-01-01 00:00:00+00:00')"
   └── render                      |                                                |
        │                          | extract('second', '2024-01-01 00:00:00+00:00') | 0.0
        └── limit                  |                                                |
             │                     | count                                          | 1
             └── merge-join        |                                                |
                  │                | type                                           | inner
                  │                | equality                                       | (col1) = (e1)
                  │                | left cols are key                              |
                  │                | mergeJoinOrder                                 | +"(col1=e1)"
                  ├── scan         |                                                |
                  │                | table                                          | test1@primary
                  │                | spans                                          | /1000-/1000/#
                  └── synchronizer |                                                |
                       └── ts scan |                                                |
                                   | ts-table                                       | ts_table
                                   | access mode                                    | metaTable
                                   | filter                                         | e1 = 1000
(21 rows)
> CREATE ts DATABASE test_select_join;
CREATE TS DATABASE
> CREATE TABLE test_select_join.t1(
    k_timestamp TIMESTAMPTZ NOT NULL,
    id INT NOT NULL,
    e1 INT2,
    e2 INT,
    e3 INT8,
    e4 FLOAT4,
    e5 FLOAT8,
    e6 BOOL,
    e7 TIMESTAMPTZ,
    e8 CHAR(1023),
    e9 NCHAR(255),
    e10 VARCHAR(4096),
    e11 CHAR,
    e12 CHAR(255),
    e13 NCHAR,
    e14 NVARCHAR(4096),
    e15 VARCHAR(1023),
    e16 NVARCHAR(200),
    e17 NCHAR(255),
    e18 CHAR(200),e19 VARBYTES,
    e20 VARBYTES(60),
    e21 VARCHAR,
    e22 NVARCHAR)
ATTRIBUTES (
    code1 INT2 NOT NULL,code2 INT,code3 INT8,
    code4 FLOAT4 ,code5 FLOAT8,
    code6 BOOL,
    code7 VARCHAR,code8 VARCHAR(128) NOT NULL,
    code9 VARBYTES,code10 VARBYTES(60),
    code11 VARCHAR,code12 VARCHAR(60),
    code13 CHAR(2),code14 CHAR(1023) NOT NULL,
    code15 NCHAR,code16 NCHAR(254) NOT NULL)
PRIMARY TAGS(code1,code14,code8,code16);
CREATE TABLE
> INSERT INTO test_select_join.t1 VALUES(0,1,0,0,0,0,0,true,0,'','','','','','','','','','','','','','','',0,0,0,0,0,false,'','','','','','','','','','');
INSERT 1
> SELECT CAST(999999999999999999999 AS INT8) FROM test_select_join.t1 ORDER BY id;
ERROR: integer out of range
SQLSTATE: 22003
> use defaultdb;
SET
> drop database test cascade;
DROP DATABASE
> drop database test_ts cascade;
DROP DATABASE
> DROP DATABASE test_select_join cascade;
DROP DATABASE
